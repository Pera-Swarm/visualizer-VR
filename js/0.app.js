(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,function(e,t){e.exports=function(e){var t=e.MOUSE;function n(t){this.object=t,this.target=new e.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25;var n,o,i,a,r,s,c,l,h=this,u=1e-6,d=0,m=0,p=1,g=new e.Vector3,f=!1;this.getPolarAngle=function(){return o},this.getAzimuthalAngle=function(){return n},this.rotateLeft=function(e){m-=e},this.rotateUp=function(e){d-=e},this.panLeft=(i=new e.Vector3,function(e){var t=this.object.matrix.elements;i.set(t[0],t[1],t[2]),i.multiplyScalar(-e),g.add(i)}),this.panUp=function(){var t=new e.Vector3;return function(e){var n=this.object.matrix.elements;t.set(n[4],n[5],n[6]),t.multiplyScalar(e),g.add(t)}}(),this.pan=function(t,n,o,i){if(h.object instanceof e.PerspectiveCamera){var a=h.object.position.clone().sub(h.target).length();a*=Math.tan(h.object.fov/2*Math.PI/180),h.panLeft(2*t*a/i),h.panUp(2*n*a/i)}else h.object instanceof e.OrthographicCamera?(h.panLeft(t*(h.object.right-h.object.left)/o),h.panUp(n*(h.object.top-h.object.bottom)/i)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(t){h.object instanceof e.PerspectiveCamera?p/=t:h.object instanceof e.OrthographicCamera?(h.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*t)),h.object.updateProjectionMatrix(),f=!0):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.dollyOut=function(t){h.object instanceof e.PerspectiveCamera?p*=t:h.object instanceof e.OrthographicCamera?(h.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/t)),h.object.updateProjectionMatrix(),f=!0):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.update=(a=new e.Vector3,r=(new e.Quaternion).setFromUnitVectors(t.up,new e.Vector3(0,1,0)),s=r.clone().inverse(),c=new e.Vector3,l=new e.Quaternion,function(){var e=this.object.position;a.copy(e).sub(this.target),a.applyQuaternion(r),n=Math.atan2(a.x,a.z),o=Math.atan2(Math.sqrt(a.x*a.x+a.z*a.z),a.y),n+=m,o+=d,n=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,n)),o=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,o)),o=Math.max(u,Math.min(Math.PI-u,o));var t=a.length()*p;return t=Math.max(this.minDistance,Math.min(this.maxDistance,t)),this.target.add(g),a.x=t*Math.sin(o)*Math.sin(n),a.y=t*Math.cos(o),a.z=t*Math.sin(o)*Math.cos(n),a.applyQuaternion(s),e.copy(this.target).add(a),this.object.lookAt(this.target),!0===this.enableDamping?(m*=1-this.dampingFactor,d*=1-this.dampingFactor):(m=0,d=0),p=1,g.set(0,0,0),!!(f||c.distanceToSquared(this.object.position)>u||8*(1-l.dot(this.object.quaternion))>u)&&(c.copy(this.object.position),l.copy(this.object.quaternion),f=!1,!0)})}function o(t,o){var i=new n(t);this.domElement=void 0!==o?o:document,Object.defineProperty(this,"constraint",{get:function(){return i}}),this.getPolarAngle=function(){return i.getPolarAngle()},this.getAzimuthalAngle=function(){return i.getAzimuthalAngle()},this.enabled=!0,this.center=this.target,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:e.MOUSE.LEFT,ZOOM:e.MOUSE.MIDDLE,PAN:e.MOUSE.RIGHT};var a=this,r=new e.Vector2,s=new e.Vector2,c=new e.Vector2,l=new e.Vector2,h=new e.Vector2,u=new e.Vector2,d=new e.Vector2,m=new e.Vector2,p=new e.Vector2,g=-1,f=0,b=1,w=2,y=3,v=4,M=5,E=g;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var L={type:"change"},x={type:"start"},k={type:"end"};function P(e,t){var n=a.domElement===document?a.domElement.body:a.domElement;i.pan(e,t,n.clientWidth,n.clientHeight)}function S(){return Math.pow(.95,a.zoomSpeed)}function R(e){if(!1!==a.enabled){if(e.preventDefault(),e.button===a.mouseButtons.ORBIT){if(!1===a.enableRotate)return;E=f,r.set(e.clientX,e.clientY)}else if(e.button===a.mouseButtons.ZOOM){if(!1===a.enableZoom)return;E=b,d.set(e.clientX,e.clientY)}else if(e.button===a.mouseButtons.PAN){if(!1===a.enablePan)return;E=w,l.set(e.clientX,e.clientY)}E!==g&&(document.addEventListener("mousemove",T,!1),document.addEventListener("mouseup",O,!1),a.dispatchEvent(x))}}function T(e){if(!1!==a.enabled){e.preventDefault();var t=a.domElement===document?a.domElement.body:a.domElement;if(E===f){if(!1===a.enableRotate)return;s.set(e.clientX,e.clientY),c.subVectors(s,r),i.rotateLeft(2*Math.PI*c.x/t.clientWidth*a.rotateSpeed),i.rotateUp(2*Math.PI*c.y/t.clientHeight*a.rotateSpeed),r.copy(s)}else if(E===b){if(!1===a.enableZoom)return;m.set(e.clientX,e.clientY),p.subVectors(m,d),p.y>0?i.dollyIn(S()):p.y<0&&i.dollyOut(S()),d.copy(m)}else if(E===w){if(!1===a.enablePan)return;h.set(e.clientX,e.clientY),u.subVectors(h,l),P(u.x,u.y),l.copy(h)}E!==g&&a.update()}}function O(){!1!==a.enabled&&(document.removeEventListener("mousemove",T,!1),document.removeEventListener("mouseup",O,!1),a.dispatchEvent(k),E=g)}function A(e){if(!1!==a.enabled&&!1!==a.enableZoom&&E===g){e.preventDefault(),e.stopPropagation();var t=0;void 0!==e.wheelDelta?t=e.wheelDelta:void 0!==e.detail&&(t=-e.detail),t>0?i.dollyOut(S()):t<0&&i.dollyIn(S()),a.update(),a.dispatchEvent(x),a.dispatchEvent(k)}}function C(e){if(!1!==a.enabled&&!1!==a.enableKeys&&!1!==a.enablePan)switch(e.keyCode){case a.keys.UP:P(0,a.keyPanSpeed),a.update();break;case a.keys.BOTTOM:P(0,-a.keyPanSpeed),a.update();break;case a.keys.LEFT:P(a.keyPanSpeed,0),a.update();break;case a.keys.RIGHT:P(-a.keyPanSpeed,0),a.update()}}function j(e){if(!1!==a.enabled){switch(e.touches.length){case 1:if(!1===a.enableRotate)return;E=y,r.set(e.touches[0].pageX,e.touches[0].pageY);break;case 2:if(!1===a.enableZoom)return;E=v;var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(t*t+n*n);d.set(0,o);break;case 3:if(!1===a.enablePan)return;E=M,l.set(e.touches[0].pageX,e.touches[0].pageY);break;default:E=g}E!==g&&a.dispatchEvent(x)}}function z(e){if(!1!==a.enabled){e.preventDefault(),e.stopPropagation();var t=a.domElement===document?a.domElement.body:a.domElement;switch(e.touches.length){case 1:if(!1===a.enableRotate)return;if(E!==y)return;s.set(e.touches[0].pageX,e.touches[0].pageY),c.subVectors(s,r),i.rotateLeft(2*Math.PI*c.x/t.clientWidth*a.rotateSpeed),i.rotateUp(2*Math.PI*c.y/t.clientHeight*a.rotateSpeed),r.copy(s),a.update();break;case 2:if(!1===a.enableZoom)return;if(E!==v)return;var n=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY,f=Math.sqrt(n*n+o*o);m.set(0,f),p.subVectors(m,d),p.y>0?i.dollyOut(S()):p.y<0&&i.dollyIn(S()),d.copy(m),a.update();break;case 3:if(!1===a.enablePan)return;if(E!==M)return;h.set(e.touches[0].pageX,e.touches[0].pageY),u.subVectors(h,l),P(u.x,u.y),l.copy(h),a.update();break;default:E=g}}}function G(){!1!==a.enabled&&(a.dispatchEvent(k),E=g)}function D(e){e.preventDefault()}this.update=function(){this.autoRotate&&E===g&&i.rotateLeft(2*Math.PI/60/60*a.autoRotateSpeed),!0===i.update()&&this.dispatchEvent(L)},this.reset=function(){E=g,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(L),this.update()},this.dispose=function(){this.domElement.removeEventListener("contextmenu",D,!1),this.domElement.removeEventListener("mousedown",R,!1),this.domElement.removeEventListener("mousewheel",A,!1),this.domElement.removeEventListener("MozMousePixelScroll",A,!1),this.domElement.removeEventListener("touchstart",j,!1),this.domElement.removeEventListener("touchend",G,!1),this.domElement.removeEventListener("touchmove",z,!1),document.removeEventListener("mousemove",T,!1),document.removeEventListener("mouseup",O,!1),window.removeEventListener("keydown",C,!1)},this.domElement.addEventListener("contextmenu",D,!1),this.domElement.addEventListener("mousedown",R,!1),this.domElement.addEventListener("mousewheel",A,!1),this.domElement.addEventListener("MozMousePixelScroll",A,!1),this.domElement.addEventListener("touchstart",j,!1),this.domElement.addEventListener("touchend",G,!1),this.domElement.addEventListener("touchmove",z,!1),window.addEventListener("keydown",C,!1),this.update()}return t||(t={LEFT:0,MIDDLE:1,RIGHT:2}),o.prototype=Object.create(e.EventDispatcher.prototype),o.prototype.constructor=o,Object.defineProperties(o.prototype,{object:{get:function(){return this.constraint.object}},target:{get:function(){return this.constraint.target},set:function(e){console.warn("THREE.OrbitControls: target is now immutable. Use target.set() instead."),this.constraint.target.copy(e)}},minDistance:{get:function(){return this.constraint.minDistance},set:function(e){this.constraint.minDistance=e}},maxDistance:{get:function(){return this.constraint.maxDistance},set:function(e){this.constraint.maxDistance=e}},minZoom:{get:function(){return this.constraint.minZoom},set:function(e){this.constraint.minZoom=e}},maxZoom:{get:function(){return this.constraint.maxZoom},set:function(e){this.constraint.maxZoom=e}},minPolarAngle:{get:function(){return this.constraint.minPolarAngle},set:function(e){this.constraint.minPolarAngle=e}},maxPolarAngle:{get:function(){return this.constraint.maxPolarAngle},set:function(e){this.constraint.maxPolarAngle=e}},minAzimuthAngle:{get:function(){return this.constraint.minAzimuthAngle},set:function(e){this.constraint.minAzimuthAngle=e}},maxAzimuthAngle:{get:function(){return this.constraint.maxAzimuthAngle},set:function(e){this.constraint.maxAzimuthAngle=e}},enableDamping:{get:function(){return this.constraint.enableDamping},set:function(e){this.constraint.enableDamping=e}},dampingFactor:{get:function(){return this.constraint.dampingFactor},set:function(e){this.constraint.dampingFactor=e}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.constraint.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.constraint.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.constraint.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.constraint.dampingFactor=e}}}),o}},function(e,t,n){e.exports=n(11)},,,,,function(e,t,n){},function(e,t,n){"use strict";n.r(t);var o=n(1),i={scale:.025,arena:{size:300,minX:-140,maxX:140,minY:-140,maxY:140},mqtt:{server:"swarm-gui.tk",port:8883,path:"/socket.io",user:"swarm_user",password:"swarm_usere15",channel:"v1"},isDev:!0,isShowingStats:!1,isLoaded:!1,isTweening:!1,isRotating:!1,isMouseMoving:!1,isMouseOver:!1,maxAnisotropy:1,dpr:1,easing:o.a.Easing.Quadratic.InOut,duration:500,model:{selected:0,initialTypes:["gltf"],type:"gltf"},texture:{path:"./assets/textures/",imageFiles:[{name:"UV",image:"UV_Grid_Sm.jpg"}]},mesh:{enableHelper:!1,wireframe:!1,translucent:!1,material:{color:16777215,emissive:16777215}},fog:{color:16777215,near:8e-4},camera:{fov:50,near:50,far:1e3,aspect:1,posX:0,posY:0,posZ:0},controls:{autoRotate:!1,autoRotateSpeed:-.5,rotateSpeed:.5,zoomSpeed:.8,minDistance:200,maxDistance:800,minPolarAngle:0,maxPolarAngle:7/16*Math.PI,minAzimuthAngle:-1/0,maxAzimuthAngle:1/0,enableDamping:!0,dampingFactor:.5,enableZoom:!0,target:{x:0,y:0,z:0}},ambientLight:{enabled:!0,color:1315860},directionalLight:{enabled:!0,color:15790320,intensity:.4,x:-75,y:280,z:150},shadow:{enabled:!0,helperEnabled:!1,bias:0,mapWidth:2048,mapHeight:2048,near:250,far:400,top:100,right:100,bottom:-100,left:-100},pointLight:{enabled:!0,color:16777215,intensity:.34,distance:115,x:0,y:0,z:0},hemiLight:{enabled:!0,color:13158600,groundColor:16777215,intensity:.55,x:0,y:0,z:0}},a={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",this.webgl||(e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000000">here</a>.'].join("\n")),e},addGetWebGLMessage:function(e){var t,n,o;t=void 0!==(e=e||{}).parent?e.parent:document.body,n=void 0!==e.id?e.id:"oldie",(o=this.getWebGLErrorMessage()).id=n,t.appendChild(o)}},r=n(0),s=n(2);function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var l=function(){function e(t,n){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.container=n,this.threeRenderer=new r.WebGLRenderer({antialias:!0,alpha:!0}),this.threeRenderer.setClearColor(new r.Color("lightgrey"),0),this.threeRenderer.setPixelRatio(window.devicePixelRatio),this.threeRenderer.setSize(window.innerWidth,window.innerHeight),this.threeRenderer.domElement.style.position="absolute",this.threeRenderer.domElement.style.top="0px",this.threeRenderer.domElement.style.left="0px",n.appendChild(this.threeRenderer.domElement),this.threeRenderer.shadowMap.enabled=!0,this.threeRenderer.shadowMap.type=r.PCFSoftShadowMap,i.maxAnisotropy=this.threeRenderer.capabilities.getMaxAnisotropy(),this.updateSize(),document.addEventListener("DOMContentLoaded",(function(){return o.updateSize()}),!1),window.addEventListener("resize",(function(){return o.updateSize()}),!1)}var t,n,o;return t=e,(n=[{key:"updateSize",value:function(){this.threeRenderer.setSize(this.container.offsetWidth,this.container.offsetHeight)}},{key:"render",value:function(e,t){this.threeRenderer.render(e,t)}}])&&c(t.prototype,n),o&&c(t,o),e}();function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.init()}var t,n,o;return t=e,(n=[{key:"init",value:function(){this.ambientLight=new r.AmbientLight(i.ambientLight.color),this.ambientLight.visible=i.ambientLight.enabled,this.pointLight=new r.PointLight(i.pointLight.color,i.pointLight.intensity,i.pointLight.distance),this.pointLight.position.set(i.pointLight.x,i.pointLight.y,i.pointLight.z),this.pointLight.visible=i.pointLight.enabled,this.directionalLight=new r.DirectionalLight(i.directionalLight.color,i.directionalLight.intensity),this.directionalLight.position.set(i.directionalLight.x,i.directionalLight.y,i.directionalLight.z),this.directionalLight.visible=i.directionalLight.enabled,this.directionalLight.castShadow=i.shadow.enabled,this.directionalLight.shadow.bias=i.shadow.bias,this.directionalLight.shadow.camera.near=i.shadow.near,this.directionalLight.shadow.camera.far=i.shadow.far,this.directionalLight.shadow.camera.left=i.shadow.left,this.directionalLight.shadow.camera.right=i.shadow.right,this.directionalLight.shadow.camera.top=i.shadow.top,this.directionalLight.shadow.camera.bottom=i.shadow.bottom,this.directionalLight.shadow.mapSize.width=i.shadow.mapWidth,this.directionalLight.shadow.mapSize.height=i.shadow.mapHeight,this.directionalLightHelper=new r.CameraHelper(this.directionalLight.shadow.camera),this.directionalLightHelper.visible=i.shadow.helperEnabled,this.hemiLight=new r.HemisphereLight(i.hemiLight.color,i.hemiLight.groundColor,i.hemiLight.intensity),this.hemiLight.position.set(i.hemiLight.x,i.hemiLight.y,i.hemiLight.z),this.hemiLight.visible=i.hemiLight.enabled}},{key:"place",value:function(e){switch(e){case"ambient":this.scene.add(this.ambientLight);break;case"directional":this.scene.add(this.directionalLight),this.scene.add(this.directionalLightHelper);break;case"point":this.scene.add(this.pointLight);break;case"hemi":this.scene.add(this.hemiLight)}}}])&&h(t.prototype,n),o&&h(t,o),e}();n(4);var d,m,p,g,f=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=new r.PlaneBufferGeometry(i.arena.size,i.arena.size),n=new r.MeshPhongMaterial({color:10066329,depthWrite:!1}),o=new r.Mesh(t,n);o.rotation.x=-Math.PI/2,o.scale.set(scene_scale,scene_scale,scene_scale),o.position.set(0,0,0),o.material.opacity=.5,o.receiveShadow=!0,markerGroup.add(o);var a=new r.GridHelper(i.arena.size,30,0,5987163);a.position.set(0,0,0),a.scale.set(scene_scale,scene_scale,scene_scale),a.material.opacity=.35,a.material.transparent=!0,markerGroup.add(a)};function b(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var w=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.renderer=t}var t,n,o;return t=e,o=[{key:"start",value:function(){d("frame").start(),p.start(),d("rAF").tick(),d("FPS").frame(),d("render").start()}},{key:"end",value:function(){d("render").end(),d("frame").end(),d("rStats").start(),d().update(),d("rStats").end()}}],(n=[{key:"setUp",value:function(){m=new BrowserStats,p=new glStats,g=new threeStats(this.renderer),d=new rStats({CSSPath:"./css/",userTimingAPI:!0,values:{frame:{caption:"Total frame time (ms)",over:16,average:!0,avgMs:100},fps:{caption:"Framerate (FPS)",below:30},calls:{caption:"Calls (three.js)",over:3e3},raf:{caption:"Time since last rAF (ms)",average:!0,avgMs:100},rstats:{caption:"rStats update (ms)",average:!0,avgMs:100},texture:{caption:"GenTex",average:!0,avgMs:100}},groups:[{caption:"Framerate",values:["fps","raf"]},{caption:"Frame Budget",values:["frame","texture","setup","render"]}],fractions:[{base:"frame",steps:["texture","setup","render"]}],plugins:[m,g]})}}])&&b(t.prototype,n),o&&b(t,o),e}();var y=n(3),v=n.n(y);function M(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var E=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.scale=scene_scale,null!=n&&n()}var t,n,o;return t=e,(n=[{key:"createList",value:function(e){var t=this;Object.entries(e).forEach((function(e){null!=e&&t.create(e[1])}))}},{key:"create",value:function(e){var t=this.createGeometry(e.geometry),n=this.createMaterial(e.material),o=e.id||1e3+Math.floor(900*Math.random()),a=new r.Mesh(t,n);if(a.name="obstacle_"+o,this.deleteIfExists(o),window.markerGroup.add(a),null!=e.position){var s=e.position,c=s.x,l=s.y,h=this.calculateZ(e);a.scale.set(this.scale,this.scale,this.scale),a.position.set(this.scale*c,this.scale*h,-1*this.scale*l)}if(null!=e.rotation){var u=e.rotation,d=u.x,m=u.y,p=u.z,g=d/360*2*Math.PI,f=m/360*2*Math.PI,b=p/360*2*Math.PI;a.rotation.set(g,f,b)}i.shadow.enabled&&(a.receiveShadow=!0),console.log("Created>",a.name)}},{key:"createGeometry",value:function(e){if(null==e.type)throw new TypeError("type unspecified");if("BoxGeometry"==e.type)return this.createBoxGeometry(e.width,e.height,e.depth);if("CylinderGeometry"==e.type)return this.createCylinderGeometry(e.radiusTop,e.radiusBottom,e.height);if("SphereGeometry"==e.type)return this.createSphereGeometry(e.radius);throw new TypeError("unsupported geometry type")}},{key:"createBoxGeometry",value:function(e,t,n){if(null==e)throw new TypeError("width unspecified");if(null==t)throw new TypeError("height unspecified");if(null==n)throw new TypeError("depth unspecified");return new r.BoxGeometry(e,t,n)}},{key:"createCylinderGeometry",value:function(e,t,n){if(null==e)throw new TypeError("radiusTop unspecified");if(null==t)throw new TypeError("radiusBottom unspecified");if(null==n)throw new TypeError("height unspecified");var o=o||2,i=i||16;return new r.CylinderGeometry(e,t,n,i,o)}},{key:"createSphereGeometry",value:function(e){if(null==e)throw new TypeError("radius unspecified");var t=t||16,n=n||16;return new r.SphereGeometry(e,t,n)}},{key:"createMaterial",value:function(e){return"MeshBasicMaterial"==e.type?new r.MeshBasicMaterial(e.properties):"MeshNormalMaterial"==e.type?new r.MeshNormalMaterial(e.properties):"MeshPhongMaterial"==e.type?new r.MeshPhongMaterial(e.properties):"MeshPhysicalMaterial"==e.type?new r.MeshPhysicalMaterial(e.properties):(e.type,new r.MeshStandardMaterial(e.properties))}},{key:"calculateZ",value:function(e){return null==e.position.z?null!=e.geometry.height?e.geometry.height/2:null!=e.geometry.radius?e.geometry.radius:0:e.position.z}},{key:"deleteIfExists",value:function(e){var t="obstacle_"+e,n=window.markerGroup.getObjectByName(t);null!=n&&(window.markerGroup.remove(n),console.log("Deleted>",t))}},{key:"deleteAll",value:function(){var e=window.markerGroup.children;Object.entries(e).forEach((function(e){var t=e[1].name;t.startsWith("obstacle_")&&(console.log("Deleted>",t),window.markerGroup.remove(e[1]))}))}}])&&M(t.prototype,n),o&&M(t,o),e}();function L(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var x=n(9)(r),k=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.scale=scene_scale}var t,n,a;return t=e,(n=[{key:"changeColor",value:function(e,t,n,o,i,a){var r=window.markerGroup.getObjectByName("robot_"+e);return null!=r?(r.material.color.setRGB(t/256,n/256,o/265),null!=a&&a("success")):null!=a&&a("undefined"),r}},{key:"create",value:function(e,t,n,o,a){var s=window.markerGroup.getObjectByName("robot_"+e);return null==s?(t=this.scale*Math.min(Math.max(t,i.arena.minX),i.arena.maxX),n=this.scale*Math.min(Math.max(n,i.arena.minY),i.arena.maxY),(new x).load("./assets/models/model.stl",(function(i,s){var c=new r.MeshStandardMaterial({color:6710886}),l=window.scene_scale||.1;console.log("scale",l);var h=new r.Mesh(i,c);h.receiveShadow=!0,h.name="robot_"+e,h.scale.set(l,l,l),h.position.set(t,0,-1*n),h.rotation.y=(o-90)*r.Math.DEG2RAD,window.markerGroup.add(h),h.clickEvent=function(e){window.robot.alert(e)},console.log("Created> Robot: id:",e," | x:",t,"y:",n,"heading:",o),null!=a&&a("success")}))):this.move(e,t,n,o,(function(){null!=a&&a("already defined, so moved")})),s}},{key:"delete",value:function(e,t){if(null!=e){var n=window.markerGroup.getObjectByName("robot_"+e);null!=n?(scene.remove(n),console.log("Deleted> id:",e),null!=t&&t("success")):null!=t&&t("not found")}else null!=t&&t("id not specified")}},{key:"deleteAll",value:function(){var e=window.markerGroup.children;Object.entries(e).forEach((function(e){var t=e[1].name;t.startsWith("robot_")&&(console.log("Deleted>",t),window.markerGroup.remove(e[1]))}))}},{key:"exists",value:function(e){return window.markerGroup.getObjectByName("robot_"+e)}},{key:"move",value:function(e,t,n,a,s){var c=window.markerGroup.getObjectByName("robot_"+e);if(null!=c){var l=c.rotation.y,h=(a-90)*r.Math.DEG2RAD,u={x:c.position.x,y:c.position.z,heading:c.rotation.y},d=l*h>=0;return t=this.scale*Math.min(Math.max(Math.round(10*t)/10,i.arena.minX),i.arena.maxX),n=-1*this.scale*Math.min(Math.max(Math.round(10*n)/10,i.arena.minY),i.arena.maxY),a=Math.round(10*a)/10,0!=Math.sqrt(Math.pow(t-u.x,2)+Math.pow(n-u.y,2))?new o.a.Tween(u).to({x:t,y:n,heading:h},1e3).onUpdate((function(){c.position.x=u.x,c.position.z=u.y,d&&(c.rotation.y=u.heading)})).onComplete((function(){c.rotation.y=u.heading,null!=s&&s("success")})).delay(50).start():c.rotation.y=h,c}null!=s&&s("undefined")}},{key:"get_coordinates",value:function(e){var t=window.markerGroup.getObjectByName("robot_"+e);return null!=t?(console.log("".concat(t.position.x,",").concat(t.position.y,",").concat(t.position.z)),t):null}},{key:"update",value:function(){o.a.update()}},{key:"alert",value:function(e){var t=document.querySelector("#msg-box");t.innerHTML=e.name,t.style.display="block",setTimeout((function(){document.querySelector("#msg-box").style.display="none"}),1e3)}}])&&L(t.prototype,n),a&&L(t,a),e}();function P(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var S,R=function(){function e(t,n){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markerGroup=n,this.scene=t,this.robot=new k(t),this.obstacles=new E(t),this.updateChannel();var a="client_"+Math.random().toString(36).substring(2,15);this.client=new v.a.Client(i.mqtt.server,i.mqtt.port,i.mqtt.path,a),window.mqtt=this.client,this.client.connect({userName:i.mqtt.user,password:i.mqtt.password,reconnect:!0,useSSL:!0,cleanSession:!1,onSuccess:function(){console.log("MQTT: connected"),o.subscribe("localization/info"),o.subscribe("robot/create"),o.subscribe("robot/delete"),o.subscribe("output/neopixel"),o.subscribe("obstacles"),o.subscribe("obstacles/delete"),o.subscribe("obstacles/delete/all"),o.subscribe("management/visualizer"),o.publish("obstacles/?","?"),o.publish("localization/?","?"),window.robot=o.robot,window.obstacles=o.obstacles,o.client.onMessageArrived=o.onMessageArrived,o.client.onConnectionLost=o.onConnectionLost},onFailure:function(){console.log("MQTT: connection failed")}})}var t,n,o;return t=e,(n=[{key:"updateChannel",value:function(){var e=window.location.hash;return""!=e&e.length>1?window.channel=e.substring(1):window.channel=i.mqtt.channel,console.log("MQTT: channel=",window.channel),!0}},{key:"onConnectionLost",value:function(e){0!==e.errorCode&&(console.log("MQTT: onConnectionLost:"+e.errorMessage),console.log("MQTT: reconnecting"))}},{key:"onMessageArrived",value:function(e){var t=e.payloadString.trim(),n=e.destinationName,o=n.substring(n.indexOf("/")+1);if("robot/create"==o)try{var i=JSON.parse(t);window.robot.create(i.id,i.x,i.y,i.heading)}catch(e){console.error(e)}else if("robot/delete"==o)try{i=JSON.parse(t),window.robot.delete(i.id)}catch(e){console.error(e)}else if("localization/info"==o)try{var a=JSON.parse(t);Object.entries(a).forEach((function(e){var t=e[1];null==window.robot.exists(t.id)?window.robot.create(t.id,t.x,t.y,t.heading):window.robot.move(t.id,t.x,t.y,t.heading)}))}catch(e){console.error(e)}else if("obstacles"==o)try{var r=JSON.parse(t);window.obstacles.createList(r)}catch(e){console.error(e)}else if("obstacles/delete"==o){var s=JSON.parse(t);console.log(s),window.obstacles.deleteIfExists(s.id)}else if("obstacles/delete/all"==o)window.obstacles.deleteAll();else if("output/neopixel"==o)try{var c=JSON.parse(t);window.robot.changeColor(c.id,c.R,c.G,c.B,c.ambient)}catch(e){console.error(e)}else"management/visualizer"==o&&("Refresh"===t?(console.log("page refresh request"),location.reload()):console.log(">Management:",t))}},{key:"subscribe",value:function(e,t){var n=window.channel+"/"+e;this.client.subscribe(n),console.log("MQTT: subscribed",n),null!=t&&t()}},{key:"publish",value:function(e,t,n){var o=new v.a.Message(t),i=window.channel+"/"+e;o.destinationName=i,this.client.send(o),console.log("MQTT: published",i),null!=n&&n()}}])&&P(t.prototype,n),o&&P(t,o),e}();function T(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var O=new r.Raycaster,A=new r.Vector2,C=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t,window.devicePixelRatio&&(i.dpr=window.devicePixelRatio),i.isDev,window.scene=new r.Scene,window.scene_scale=i.scale,window.renderer=new l(scene,t).threeRenderer,S=new r.Camera,scene.add(S),this.light=new u(scene);["ambient","directional","point","hemi"].forEach((function(e){return n.light.place(e)}));var a=new r.Group;scene.add(a),window.markerGroup=a;var c=new s.Source({renderer:renderer,camera:S});this.mqtt=new R(scene,a),i.isDev&&i.isShowingStats&&(this.stats=new w(renderer),this.stats.setUp()),s.initialize({source:c}).then((function(e){n.environment=new f;var t=new s.PatternMarker({patternUrl:"./assets/data/hiro.patt",markerObject:a});e.trackMarker(t);var r=0;requestAnimationFrame((function t(n){requestAnimationFrame(t),r=r||n-1e3/60;Math.min(200,n-r);r=n,e.update(c.domElement),i.isDev&&i.isShowingStats&&w.start(),renderer.render(scene,S),i.isDev&&i.isShowingStats&&w.end(),o.a.update()}))})),this.container.querySelector("#loading").style.display="none",window.addEventListener("click",this.onDocumentMouseDown,!1)}var t,n,a;return t=e,(n=[{key:"onDocumentMouseDown",value:function(e){e.preventDefault(),A.x=e.clientX/window.innerWidth*2-1,A.y=-e.clientY/window.innerHeight*2+1,O.setFromCamera(A,S);var t=O.intersectObjects(scene.children);if(t.length>0){var n=t[0].object;null!=n.clickEvent&&n.clickEvent(n)}}}])&&T(t.prototype,n),a&&T(t,a),e}();n(10);(function(){if(a.webgl){var e=document.getElementById("appContainer");new C(e)}else a.addGetWebGLMessage()})()}],[[5,1,2]]]);