{"version":3,"sources":["webpack:///./src/js/utils/orbitControls.js","webpack:///./src/js/data/config.js","webpack:///./src/js/utils/detector.js","webpack:///./src/js/app/components/renderer.js","webpack:///./src/js/app/components/label.js","webpack:///./src/js/app/components/light.js","webpack:///./src/js/app/helpers/coordinateTransform.js","webpack:///./src/js/app/helpers/stats.js","webpack:///./src/js/app/components/environment.js","webpack:///./src/js/app/managers/datGUI.js","webpack:///./src/js/app/components/obstacle.js","webpack:///./src/js/app/components/robot.js","webpack:///./src/js/app/helpers/urlHelper.js","webpack:///./src/js/app/managers/mqttClient.js","webpack:///./src/js/app/main.js","webpack:///./src/js/app.js"],"names":["module","exports","THREE","MOUSE","OrbitConstraint","object","this","target","Vector3","minDistance","maxDistance","Infinity","minZoom","maxZoom","minPolarAngle","maxPolarAngle","Math","PI","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","theta","phi","v","offset","quat","quatInverse","lastPosition","lastQuaternion","scope","EPS","phiDelta","thetaDelta","scale","panOffset","zoomChanged","getPolarAngle","getAzimuthalAngle","rotateLeft","angle","rotateUp","panLeft","distance","te","matrix","elements","set","multiplyScalar","add","panUp","pan","deltaX","deltaY","screenWidth","screenHeight","PerspectiveCamera","targetDistance","position","clone","sub","length","tan","fov","OrthographicCamera","right","left","top","bottom","console","warn","dollyIn","dollyScale","zoom","max","min","updateProjectionMatrix","dollyOut","update","Quaternion","setFromUnitVectors","up","inverse","copy","applyQuaternion","atan2","x","z","sqrt","y","radius","sin","cos","lookAt","distanceToSquared","dot","quaternion","OrbitControls","domElement","constraint","undefined","document","Object","defineProperty","get","enabled","center","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","keyPanSpeed","autoRotate","autoRotateSpeed","enableKeys","keys","LEFT","UP","RIGHT","BOTTOM","mouseButtons","ORBIT","ZOOM","MIDDLE","PAN","rotateStart","Vector2","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","STATE","state","target0","position0","zoom0","changeEvent","type","startEvent","endEvent","element","body","clientWidth","clientHeight","getZoomScale","pow","onMouseDown","event","preventDefault","button","clientX","clientY","addEventListener","onMouseMove","onMouseUp","dispatchEvent","subVectors","removeEventListener","onMouseWheel","stopPropagation","delta","wheelDelta","detail","onKeyDown","keyCode","touchstart","touches","pageX","pageY","dx","dy","touchmove","touchend","contextmenu","reset","dispose","window","prototype","create","EventDispatcher","constructor","defineProperties","value","noZoom","noRotate","noPan","noKeys","staticMoving","dynamicDampingFactor","resolvedConfig","config","arena","size","minX","maxX","minY","maxY","offsets","showZeroMarker","showCoordMarker","scaleRange","mqtt","server","localStorage","getItem","port","parseInt","path","channel","mixedReality","obstacles","robots","selectedReality","selectedRealities","real","virtual","hiddenOpacity","isDev","isShowingStats","isShowingLables","labelsVisibility","isShowingRobotSnapshots","isLoaded","isTweening","isRotating","isMouseMoving","isMouseOver","maxAnisotropy","dpr","easing","TWEEN","Easing","Quadratic","InOut","duration","texture","imageFiles","name","image","mesh","enableHelper","wireframe","translucent","material","color","emissive","fog","near","camera","far","aspect","posX","posY","posZ","controls","ambientLight","directionalLight","intensity","shadow","helperEnabled","bias","mapWidth","mapHeight","pointLight","hemiLight","groundColor","storedConfig","location","href","JSON","parse","saveConfig","data","setItem","stringify","canvas","CanvasRenderingContext2D","webgl","createElement","WebGLRenderingContext","getContext","e","workers","Worker","fileapi","File","FileReader","FileList","Blob","getWebGLErrorMessage","id","style","fontFamily","fontSize","fontWeight","textAlign","background","padding","width","margin","innerHTML","join","addGetWebGLMessage","parameters","parent","appendChild","Renderer","scene","container","threeRenderer","antialias","alpha","setClearColor","setPixelRatio","devicePixelRatio","setSize","innerWidth","innerHeight","shadowMap","Config","capabilities","getMaxAnisotropy","updateSize","offsetWidth","offsetHeight","render","addLabel","prefix","visibility","className","textContent","marginTop","elementLabel","CSS2DObject","visible","removeLabel","remove","Light","init","castShadow","mapSize","height","directionalLightHelper","lightName","transformPosition","abs","transformScale","scaleX","scaleY","scaleZ","transformRotation","rotX","rotY","rotZ","rS","bS","glS","tS","Environment","log","scene_scale","depthWrite","opacity","grid","rotation","markerGroup","zeroGeometry","zeroMarker","markerGeometry","coordMarker","Stats","renderer","start","tick","frame","end","BrowserStats","glStats","threeStats","rStats","CSSPath","userTimingAPI","values","caption","over","average","avgMs","fps","below","calls","raf","rstats","groups","fractions","base","steps","plugins","DatGUI","main","gui","dat","GUI","useLocalStorage","realityFolder","addFolder","listen","onChange","toggleReality","placeFolder","updateCoord","open","objects","Array","isArray","variable","startsWith","children","reality","selected","entries","forEach","obj","pos","destroy","Obstacle","callback","obs","obstacle","geometry","createGeometry","createMaterial","userData","originalColor","labelVisibility","originalEmmisive","getHex","transparent","floor","random","name_temp","toString","substring","deleteIfExists","calculateZ","receiveShadow","g","TypeError","createBoxGeometry","depth","createCylinderGeometry","radiusTop","radiusBottom","createSphereGeometry","heightSegments","radialSegments","widthSegments","m","properties","getObjectByName","STLLoader","require","Robot","that","created","setInterval","prune","heading","r","REALITY","loader","load","robotId","clickEvent","robot","alert","error","setReality","currentHeading","newHeading","DEG2RAD","rotationFlag","round","Tween","to","onUpdate","onComplete","delay","R","G","B","setRGB","Promise","resolve","reject","publish","nodeContent","disp","querySelector","prevContent","getElementById","content","setAttribute","createTextNode","requestSnapshot","replaceChild","display","setTimeout","valid","getUrlParam","parameter","defaultvalue","vars","urlparameter","indexOf","replace","key","getCredentials","storedCredentials","username","password","origin","pathname","history","pushState","title","credentials","token","base64","split","jsonPayload","decodeURIComponent","atob","map","c","charCodeAt","slice","parseJwt","user","pass","host","MQTTClient","updateChannel","clientId","client","MQTT","Client","connect","userName","reconnect","useSSL","cleanSession","onSuccess","subscribe","onMessageArrived","onConnectionLost","onFailure","channelHash","hash","responseObject","errorCode","errorMessage","packet","msg","payloadString","trim","t","destinationName","topic","i","exists","move","createList","deleteAll","changeColor","reload","subTopic","message","payload","Message","pubTopic","send","Main","light","place","source","THREEAR","stats","labelRenderer","CSS2DRenderer","isShowingObstacleLables","isShowingRobotLables","Label","then","controller","environment","patternMarker","patternUrl","markerObject","trackMarker","lastTimeMsec","requestAnimationFrame","animate","nowMsec","hidden","onDocumentMouseDown","Detector"],"mappings":"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","file":"0.app.js","sourcesContent":["module.exports = function (THREE) {\n    var MOUSE = THREE.MOUSE;\n    if (!MOUSE) MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2 };\n\n    /**\n     * @author qiao / https://github.com/qiao\n     * @author mrdoob / http://mrdoob.com\n     * @author alteredq / http://alteredqualia.com/\n     * @author WestLangley / http://github.com/WestLangley\n     * @author erich666 / http://erichaines.com\n     */\n    /*global THREE, console */\n\n    function OrbitConstraint(object) {\n        this.object = object;\n\n        // \"target\" sets the location of focus, where the object orbits around\n        // and where it pans with respect to.\n        this.target = new THREE.Vector3();\n\n        // Limits to how far you can dolly in and out ( PerspectiveCamera only )\n        this.minDistance = 0;\n        this.maxDistance = Infinity;\n\n        // Limits to how far you can zoom in and out ( OrthographicCamera only )\n        this.minZoom = 0;\n        this.maxZoom = Infinity;\n\n        // How far you can orbit vertically, upper and lower limits.\n        // Range is 0 to Math.PI radians.\n        this.minPolarAngle = 0; // radians\n        this.maxPolarAngle = Math.PI; // radians\n\n        // How far you can orbit horizontally, upper and lower limits.\n        // If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n        this.minAzimuthAngle = -Infinity; // radians\n        this.maxAzimuthAngle = Infinity; // radians\n\n        // Set to true to enable damping (inertia)\n        // If damping is enabled, you must call controls.update() in your animation loop\n        this.enableDamping = false;\n        this.dampingFactor = 0.25;\n\n        ////////////\n        // internals\n\n        var scope = this;\n\n        var EPS = 0.000001;\n\n        // Current position in spherical coordinate system.\n        var theta;\n        var phi;\n\n        // Pending changes\n        var phiDelta = 0;\n        var thetaDelta = 0;\n        var scale = 1;\n        var panOffset = new THREE.Vector3();\n        var zoomChanged = false;\n\n        // API\n\n        this.getPolarAngle = function () {\n            return phi;\n        };\n\n        this.getAzimuthalAngle = function () {\n            return theta;\n        };\n\n        this.rotateLeft = function (angle) {\n            thetaDelta -= angle;\n        };\n\n        this.rotateUp = function (angle) {\n            phiDelta -= angle;\n        };\n\n        // pass in distance in world space to move left\n        this.panLeft = (function () {\n            var v = new THREE.Vector3();\n\n            return function panLeft(distance) {\n                var te = this.object.matrix.elements;\n\n                // get X column of matrix\n                v.set(te[0], te[1], te[2]);\n                v.multiplyScalar(-distance);\n\n                panOffset.add(v);\n            };\n        })();\n\n        // pass in distance in world space to move up\n        this.panUp = (function () {\n            var v = new THREE.Vector3();\n\n            return function panUp(distance) {\n                var te = this.object.matrix.elements;\n\n                // get Y column of matrix\n                v.set(te[4], te[5], te[6]);\n                v.multiplyScalar(distance);\n\n                panOffset.add(v);\n            };\n        })();\n\n        // pass in x,y of change desired in pixel space,\n        // right and down are positive\n        this.pan = function (deltaX, deltaY, screenWidth, screenHeight) {\n            if (scope.object instanceof THREE.PerspectiveCamera) {\n                // perspective\n                var position = scope.object.position;\n                var offset = position.clone().sub(scope.target);\n                var targetDistance = offset.length();\n\n                // half of the fov is center to top of screen\n                targetDistance *= Math.tan(((scope.object.fov / 2) * Math.PI) / 180.0);\n\n                // we actually don't use screenWidth, since perspective camera is fixed to screen height\n                scope.panLeft((2 * deltaX * targetDistance) / screenHeight);\n                scope.panUp((2 * deltaY * targetDistance) / screenHeight);\n            } else if (scope.object instanceof THREE.OrthographicCamera) {\n                // orthographic\n                scope.panLeft((deltaX * (scope.object.right - scope.object.left)) / screenWidth);\n                scope.panUp((deltaY * (scope.object.top - scope.object.bottom)) / screenHeight);\n            } else {\n                // camera neither orthographic or perspective\n                console.warn('WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.');\n            }\n        };\n\n        this.dollyIn = function (dollyScale) {\n            if (scope.object instanceof THREE.PerspectiveCamera) {\n                scale /= dollyScale;\n            } else if (scope.object instanceof THREE.OrthographicCamera) {\n                scope.object.zoom = Math.max(this.minZoom, Math.min(this.maxZoom, this.object.zoom * dollyScale));\n                scope.object.updateProjectionMatrix();\n                zoomChanged = true;\n            } else {\n                console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.');\n            }\n        };\n\n        this.dollyOut = function (dollyScale) {\n            if (scope.object instanceof THREE.PerspectiveCamera) {\n                scale *= dollyScale;\n            } else if (scope.object instanceof THREE.OrthographicCamera) {\n                scope.object.zoom = Math.max(this.minZoom, Math.min(this.maxZoom, this.object.zoom / dollyScale));\n                scope.object.updateProjectionMatrix();\n                zoomChanged = true;\n            } else {\n                console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.');\n            }\n        };\n\n        this.update = (function () {\n            var offset = new THREE.Vector3();\n\n            // so camera.up is the orbit axis\n            var quat = new THREE.Quaternion().setFromUnitVectors(object.up, new THREE.Vector3(0, 1, 0));\n            var quatInverse = quat.clone().inverse();\n\n            var lastPosition = new THREE.Vector3();\n            var lastQuaternion = new THREE.Quaternion();\n\n            return function () {\n                var position = this.object.position;\n\n                offset.copy(position).sub(this.target);\n\n                // rotate offset to \"y-axis-is-up\" space\n                offset.applyQuaternion(quat);\n\n                // angle from z-axis around y-axis\n\n                theta = Math.atan2(offset.x, offset.z);\n\n                // angle from y-axis\n\n                phi = Math.atan2(Math.sqrt(offset.x * offset.x + offset.z * offset.z), offset.y);\n\n                theta += thetaDelta;\n                phi += phiDelta;\n\n                // restrict theta to be between desired limits\n                theta = Math.max(this.minAzimuthAngle, Math.min(this.maxAzimuthAngle, theta));\n\n                // restrict phi to be between desired limits\n                phi = Math.max(this.minPolarAngle, Math.min(this.maxPolarAngle, phi));\n\n                // restrict phi to be betwee EPS and PI-EPS\n                phi = Math.max(EPS, Math.min(Math.PI - EPS, phi));\n\n                var radius = offset.length() * scale;\n\n                // restrict radius to be between desired limits\n                radius = Math.max(this.minDistance, Math.min(this.maxDistance, radius));\n\n                // move target to panned location\n                this.target.add(panOffset);\n\n                offset.x = radius * Math.sin(phi) * Math.sin(theta);\n                offset.y = radius * Math.cos(phi);\n                offset.z = radius * Math.sin(phi) * Math.cos(theta);\n\n                // rotate offset back to \"camera-up-vector-is-up\" space\n                offset.applyQuaternion(quatInverse);\n\n                position.copy(this.target).add(offset);\n\n                this.object.lookAt(this.target);\n\n                if (this.enableDamping === true) {\n                    thetaDelta *= 1 - this.dampingFactor;\n                    phiDelta *= 1 - this.dampingFactor;\n                } else {\n                    thetaDelta = 0;\n                    phiDelta = 0;\n                }\n\n                scale = 1;\n                panOffset.set(0, 0, 0);\n\n                // update condition is:\n                // min(camera displacement, camera rotation in radians)^2 > EPS\n                // using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n                if (\n                    zoomChanged ||\n                    lastPosition.distanceToSquared(this.object.position) > EPS ||\n                    8 * (1 - lastQuaternion.dot(this.object.quaternion)) > EPS\n                ) {\n                    lastPosition.copy(this.object.position);\n                    lastQuaternion.copy(this.object.quaternion);\n                    zoomChanged = false;\n\n                    return true;\n                }\n\n                return false;\n            };\n        })();\n    }\n\n    // This set of controls performs orbiting, dollying (zooming), and panning. It maintains\n    // the \"up\" direction as +Y, unlike the TrackballControls. Touch on tablet and phones is\n    // supported.\n    //\n    //    Orbit - left mouse / touch: one finger move\n    //    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\n    //    Pan - right mouse, or arrow keys / touch: three finter swipe\n\n    function OrbitControls(object, domElement) {\n        var constraint = new OrbitConstraint(object);\n\n        this.domElement = domElement !== undefined ? domElement : document;\n\n        // API\n\n        Object.defineProperty(this, 'constraint', {\n            get: function () {\n                return constraint;\n            }\n        });\n\n        this.getPolarAngle = function () {\n            return constraint.getPolarAngle();\n        };\n\n        this.getAzimuthalAngle = function () {\n            return constraint.getAzimuthalAngle();\n        };\n\n        // Set to false to disable this control\n        this.enabled = true;\n\n        // center is old, deprecated; use \"target\" instead\n        this.center = this.target;\n\n        // This option actually enables dollying in and out; left as \"zoom\" for\n        // backwards compatibility.\n        // Set to false to disable zooming\n        this.enableZoom = true;\n        this.zoomSpeed = 1.0;\n\n        // Set to false to disable rotating\n        this.enableRotate = true;\n        this.rotateSpeed = 1.0;\n\n        // Set to false to disable panning\n        this.enablePan = true;\n        this.keyPanSpeed = 7.0; // pixels moved per arrow key push\n\n        // Set to true to automatically rotate around the target\n        // If auto-rotate is enabled, you must call controls.update() in your animation loop\n        this.autoRotate = false;\n        this.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n        // Set to false to disable use of the keys\n        this.enableKeys = true;\n\n        // The four arrow keys\n        this.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n        // Mouse buttons\n        this.mouseButtons = {\n            ORBIT: THREE.MOUSE.LEFT,\n            ZOOM: THREE.MOUSE.MIDDLE,\n            PAN: THREE.MOUSE.RIGHT\n        };\n\n        ////////////\n        // internals\n\n        var scope = this;\n\n        var rotateStart = new THREE.Vector2();\n        var rotateEnd = new THREE.Vector2();\n        var rotateDelta = new THREE.Vector2();\n\n        var panStart = new THREE.Vector2();\n        var panEnd = new THREE.Vector2();\n        var panDelta = new THREE.Vector2();\n\n        var dollyStart = new THREE.Vector2();\n        var dollyEnd = new THREE.Vector2();\n        var dollyDelta = new THREE.Vector2();\n\n        var STATE = {\n            NONE: -1,\n            ROTATE: 0,\n            DOLLY: 1,\n            PAN: 2,\n            TOUCH_ROTATE: 3,\n            TOUCH_DOLLY: 4,\n            TOUCH_PAN: 5\n        };\n\n        var state = STATE.NONE;\n\n        // for reset\n\n        this.target0 = this.target.clone();\n        this.position0 = this.object.position.clone();\n        this.zoom0 = this.object.zoom;\n\n        // events\n\n        var changeEvent = { type: 'change' };\n        var startEvent = { type: 'start' };\n        var endEvent = { type: 'end' };\n\n        // pass in x,y of change desired in pixel space,\n        // right and down are positive\n        function pan(deltaX, deltaY) {\n            var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n            constraint.pan(deltaX, deltaY, element.clientWidth, element.clientHeight);\n        }\n\n        this.update = function () {\n            if (this.autoRotate && state === STATE.NONE) {\n                constraint.rotateLeft(getAutoRotationAngle());\n            }\n\n            if (constraint.update() === true) {\n                this.dispatchEvent(changeEvent);\n            }\n        };\n\n        this.reset = function () {\n            state = STATE.NONE;\n\n            this.target.copy(this.target0);\n            this.object.position.copy(this.position0);\n            this.object.zoom = this.zoom0;\n\n            this.object.updateProjectionMatrix();\n            this.dispatchEvent(changeEvent);\n\n            this.update();\n        };\n\n        function getAutoRotationAngle() {\n            return ((2 * Math.PI) / 60 / 60) * scope.autoRotateSpeed;\n        }\n\n        function getZoomScale() {\n            return Math.pow(0.95, scope.zoomSpeed);\n        }\n\n        function onMouseDown(event) {\n            if (scope.enabled === false) return;\n\n            event.preventDefault();\n\n            if (event.button === scope.mouseButtons.ORBIT) {\n                if (scope.enableRotate === false) return;\n\n                state = STATE.ROTATE;\n\n                rotateStart.set(event.clientX, event.clientY);\n            } else if (event.button === scope.mouseButtons.ZOOM) {\n                if (scope.enableZoom === false) return;\n\n                state = STATE.DOLLY;\n\n                dollyStart.set(event.clientX, event.clientY);\n            } else if (event.button === scope.mouseButtons.PAN) {\n                if (scope.enablePan === false) return;\n\n                state = STATE.PAN;\n\n                panStart.set(event.clientX, event.clientY);\n            }\n\n            if (state !== STATE.NONE) {\n                document.addEventListener('mousemove', onMouseMove, false);\n                document.addEventListener('mouseup', onMouseUp, false);\n                scope.dispatchEvent(startEvent);\n            }\n        }\n\n        function onMouseMove(event) {\n            if (scope.enabled === false) return;\n\n            event.preventDefault();\n\n            var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n            if (state === STATE.ROTATE) {\n                if (scope.enableRotate === false) return;\n\n                rotateEnd.set(event.clientX, event.clientY);\n                rotateDelta.subVectors(rotateEnd, rotateStart);\n\n                // rotating across whole screen goes 360 degrees around\n                constraint.rotateLeft(((2 * Math.PI * rotateDelta.x) / element.clientWidth) * scope.rotateSpeed);\n\n                // rotating up and down along whole screen attempts to go 360, but limited to 180\n                constraint.rotateUp(((2 * Math.PI * rotateDelta.y) / element.clientHeight) * scope.rotateSpeed);\n\n                rotateStart.copy(rotateEnd);\n            } else if (state === STATE.DOLLY) {\n                if (scope.enableZoom === false) return;\n\n                dollyEnd.set(event.clientX, event.clientY);\n                dollyDelta.subVectors(dollyEnd, dollyStart);\n\n                if (dollyDelta.y > 0) {\n                    constraint.dollyIn(getZoomScale());\n                } else if (dollyDelta.y < 0) {\n                    constraint.dollyOut(getZoomScale());\n                }\n\n                dollyStart.copy(dollyEnd);\n            } else if (state === STATE.PAN) {\n                if (scope.enablePan === false) return;\n\n                panEnd.set(event.clientX, event.clientY);\n                panDelta.subVectors(panEnd, panStart);\n\n                pan(panDelta.x, panDelta.y);\n\n                panStart.copy(panEnd);\n            }\n\n            if (state !== STATE.NONE) scope.update();\n        }\n\n        function onMouseUp(/* event */) {\n            if (scope.enabled === false) return;\n\n            document.removeEventListener('mousemove', onMouseMove, false);\n            document.removeEventListener('mouseup', onMouseUp, false);\n            scope.dispatchEvent(endEvent);\n            state = STATE.NONE;\n        }\n\n        function onMouseWheel(event) {\n            if (scope.enabled === false || scope.enableZoom === false || state !== STATE.NONE) return;\n\n            event.preventDefault();\n            event.stopPropagation();\n\n            var delta = 0;\n\n            if (event.wheelDelta !== undefined) {\n                // WebKit / Opera / Explorer 9\n\n                delta = event.wheelDelta;\n            } else if (event.detail !== undefined) {\n                // Firefox\n\n                delta = -event.detail;\n            }\n\n            if (delta > 0) {\n                constraint.dollyOut(getZoomScale());\n            } else if (delta < 0) {\n                constraint.dollyIn(getZoomScale());\n            }\n\n            scope.update();\n            scope.dispatchEvent(startEvent);\n            scope.dispatchEvent(endEvent);\n        }\n\n        function onKeyDown(event) {\n            if (scope.enabled === false || scope.enableKeys === false || scope.enablePan === false) return;\n\n            switch (event.keyCode) {\n                case scope.keys.UP:\n                    pan(0, scope.keyPanSpeed);\n                    scope.update();\n                    break;\n\n                case scope.keys.BOTTOM:\n                    pan(0, -scope.keyPanSpeed);\n                    scope.update();\n                    break;\n\n                case scope.keys.LEFT:\n                    pan(scope.keyPanSpeed, 0);\n                    scope.update();\n                    break;\n\n                case scope.keys.RIGHT:\n                    pan(-scope.keyPanSpeed, 0);\n                    scope.update();\n                    break;\n            }\n        }\n\n        function touchstart(event) {\n            if (scope.enabled === false) return;\n\n            switch (event.touches.length) {\n                case 1: // one-fingered touch: rotate\n                    if (scope.enableRotate === false) return;\n\n                    state = STATE.TOUCH_ROTATE;\n\n                    rotateStart.set(event.touches[0].pageX, event.touches[0].pageY);\n                    break;\n\n                case 2: // two-fingered touch: dolly\n                    if (scope.enableZoom === false) return;\n\n                    state = STATE.TOUCH_DOLLY;\n\n                    var dx = event.touches[0].pageX - event.touches[1].pageX;\n                    var dy = event.touches[0].pageY - event.touches[1].pageY;\n                    var distance = Math.sqrt(dx * dx + dy * dy);\n                    dollyStart.set(0, distance);\n                    break;\n\n                case 3: // three-fingered touch: pan\n                    if (scope.enablePan === false) return;\n\n                    state = STATE.TOUCH_PAN;\n\n                    panStart.set(event.touches[0].pageX, event.touches[0].pageY);\n                    break;\n\n                default:\n                    state = STATE.NONE;\n            }\n\n            if (state !== STATE.NONE) scope.dispatchEvent(startEvent);\n        }\n\n        function touchmove(event) {\n            if (scope.enabled === false) return;\n\n            event.preventDefault();\n            event.stopPropagation();\n\n            var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n            switch (event.touches.length) {\n                case 1: // one-fingered touch: rotate\n                    if (scope.enableRotate === false) return;\n                    if (state !== STATE.TOUCH_ROTATE) return;\n\n                    rotateEnd.set(event.touches[0].pageX, event.touches[0].pageY);\n                    rotateDelta.subVectors(rotateEnd, rotateStart);\n\n                    // rotating across whole screen goes 360 degrees around\n                    constraint.rotateLeft(((2 * Math.PI * rotateDelta.x) / element.clientWidth) * scope.rotateSpeed);\n                    // rotating up and down along whole screen attempts to go 360, but limited to 180\n                    constraint.rotateUp(((2 * Math.PI * rotateDelta.y) / element.clientHeight) * scope.rotateSpeed);\n\n                    rotateStart.copy(rotateEnd);\n\n                    scope.update();\n                    break;\n\n                case 2: // two-fingered touch: dolly\n                    if (scope.enableZoom === false) return;\n                    if (state !== STATE.TOUCH_DOLLY) return;\n\n                    var dx = event.touches[0].pageX - event.touches[1].pageX;\n                    var dy = event.touches[0].pageY - event.touches[1].pageY;\n                    var distance = Math.sqrt(dx * dx + dy * dy);\n\n                    dollyEnd.set(0, distance);\n                    dollyDelta.subVectors(dollyEnd, dollyStart);\n\n                    if (dollyDelta.y > 0) {\n                        constraint.dollyOut(getZoomScale());\n                    } else if (dollyDelta.y < 0) {\n                        constraint.dollyIn(getZoomScale());\n                    }\n\n                    dollyStart.copy(dollyEnd);\n\n                    scope.update();\n                    break;\n\n                case 3: // three-fingered touch: pan\n                    if (scope.enablePan === false) return;\n                    if (state !== STATE.TOUCH_PAN) return;\n\n                    panEnd.set(event.touches[0].pageX, event.touches[0].pageY);\n                    panDelta.subVectors(panEnd, panStart);\n\n                    pan(panDelta.x, panDelta.y);\n\n                    panStart.copy(panEnd);\n\n                    scope.update();\n                    break;\n\n                default:\n                    state = STATE.NONE;\n            }\n        }\n\n        function touchend(/* event */) {\n            if (scope.enabled === false) return;\n\n            scope.dispatchEvent(endEvent);\n            state = STATE.NONE;\n        }\n\n        function contextmenu(event) {\n            event.preventDefault();\n        }\n\n        this.dispose = function () {\n            this.domElement.removeEventListener('contextmenu', contextmenu, false);\n            this.domElement.removeEventListener('mousedown', onMouseDown, false);\n            this.domElement.removeEventListener('mousewheel', onMouseWheel, false);\n            this.domElement.removeEventListener('MozMousePixelScroll', onMouseWheel, false); // firefox\n\n            this.domElement.removeEventListener('touchstart', touchstart, false);\n            this.domElement.removeEventListener('touchend', touchend, false);\n            this.domElement.removeEventListener('touchmove', touchmove, false);\n\n            document.removeEventListener('mousemove', onMouseMove, false);\n            document.removeEventListener('mouseup', onMouseUp, false);\n\n            window.removeEventListener('keydown', onKeyDown, false);\n        };\n\n        this.domElement.addEventListener('contextmenu', contextmenu, false);\n\n        this.domElement.addEventListener('mousedown', onMouseDown, false);\n        this.domElement.addEventListener('mousewheel', onMouseWheel, false);\n        this.domElement.addEventListener('MozMousePixelScroll', onMouseWheel, false); // firefox\n\n        this.domElement.addEventListener('touchstart', touchstart, false);\n        this.domElement.addEventListener('touchend', touchend, false);\n        this.domElement.addEventListener('touchmove', touchmove, false);\n\n        window.addEventListener('keydown', onKeyDown, false);\n\n        // force an update at start\n        this.update();\n    }\n\n    OrbitControls.prototype = Object.create(THREE.EventDispatcher.prototype);\n    OrbitControls.prototype.constructor = OrbitControls;\n\n    Object.defineProperties(OrbitControls.prototype, {\n        object: {\n            get: function () {\n                return this.constraint.object;\n            }\n        },\n\n        target: {\n            get: function () {\n                return this.constraint.target;\n            },\n\n            set: function (value) {\n                console.warn('THREE.OrbitControls: target is now immutable. Use target.set() instead.');\n                this.constraint.target.copy(value);\n            }\n        },\n\n        minDistance: {\n            get: function () {\n                return this.constraint.minDistance;\n            },\n\n            set: function (value) {\n                this.constraint.minDistance = value;\n            }\n        },\n\n        maxDistance: {\n            get: function () {\n                return this.constraint.maxDistance;\n            },\n\n            set: function (value) {\n                this.constraint.maxDistance = value;\n            }\n        },\n\n        minZoom: {\n            get: function () {\n                return this.constraint.minZoom;\n            },\n\n            set: function (value) {\n                this.constraint.minZoom = value;\n            }\n        },\n\n        maxZoom: {\n            get: function () {\n                return this.constraint.maxZoom;\n            },\n\n            set: function (value) {\n                this.constraint.maxZoom = value;\n            }\n        },\n\n        minPolarAngle: {\n            get: function () {\n                return this.constraint.minPolarAngle;\n            },\n\n            set: function (value) {\n                this.constraint.minPolarAngle = value;\n            }\n        },\n\n        maxPolarAngle: {\n            get: function () {\n                return this.constraint.maxPolarAngle;\n            },\n\n            set: function (value) {\n                this.constraint.maxPolarAngle = value;\n            }\n        },\n\n        minAzimuthAngle: {\n            get: function () {\n                return this.constraint.minAzimuthAngle;\n            },\n\n            set: function (value) {\n                this.constraint.minAzimuthAngle = value;\n            }\n        },\n\n        maxAzimuthAngle: {\n            get: function () {\n                return this.constraint.maxAzimuthAngle;\n            },\n\n            set: function (value) {\n                this.constraint.maxAzimuthAngle = value;\n            }\n        },\n\n        enableDamping: {\n            get: function () {\n                return this.constraint.enableDamping;\n            },\n\n            set: function (value) {\n                this.constraint.enableDamping = value;\n            }\n        },\n\n        dampingFactor: {\n            get: function () {\n                return this.constraint.dampingFactor;\n            },\n\n            set: function (value) {\n                this.constraint.dampingFactor = value;\n            }\n        },\n\n        // backward compatibility\n\n        noZoom: {\n            get: function () {\n                console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.');\n                return !this.enableZoom;\n            },\n\n            set: function (value) {\n                console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.');\n                this.enableZoom = !value;\n            }\n        },\n\n        noRotate: {\n            get: function () {\n                console.warn('THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.');\n                return !this.enableRotate;\n            },\n\n            set: function (value) {\n                console.warn('THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.');\n                this.enableRotate = !value;\n            }\n        },\n\n        noPan: {\n            get: function () {\n                console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.');\n                return !this.enablePan;\n            },\n\n            set: function (value) {\n                console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.');\n                this.enablePan = !value;\n            }\n        },\n\n        noKeys: {\n            get: function () {\n                console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.');\n                return !this.enableKeys;\n            },\n\n            set: function (value) {\n                console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.');\n                this.enableKeys = !value;\n            }\n        },\n\n        staticMoving: {\n            get: function () {\n                console.warn('THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.');\n                return !this.constraint.enableDamping;\n            },\n\n            set: function (value) {\n                console.warn('THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.');\n                this.constraint.enableDamping = !value;\n            }\n        },\n\n        dynamicDampingFactor: {\n            get: function () {\n                console.warn(\n                    'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'\n                );\n                return this.constraint.dampingFactor;\n            },\n\n            set: function (value) {\n                console.warn(\n                    'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'\n                );\n                this.constraint.dampingFactor = value;\n            }\n        }\n    });\n\n    return OrbitControls;\n};\n","import TWEEN from '@tweenjs/tween.js';\n\nlet resolvedConfig;\n\n// This object contains the state of the app\nconst config = {\n    scale: 0.015,\n    arena: {\n        size: 180,\n        minX: -85,\n        maxX: 85,\n        minY: -85,\n        maxY: 85\n    },\n    offsets: {\n        x: 0,\n        y: 80,\n        z: 150,\n        showZeroMarker: true,\n        showCoordMarker: false,\n        scaleRange: 360\n    },\n    mqtt: {\n        server: localStorage.getItem('pera-swarm-server') || 'webservices.ceykod.com',\n        port: parseInt(localStorage.getItem('pera-swarm-port')) || 8883,\n        path: localStorage.getItem('pera-swarm-path') || '/mqtt',\n        channel: localStorage.getItem('pera-swarm-channel') || 'v1'\n    },\n    mixedReality: {\n        obstacles: 'M',\n        robots: 'M'\n    },\n    selectedReality: 'M',\n    selectedRealities: {\n        real: true,\n        virtual: true\n    },\n    hiddenOpacity: 0.15,\n    isDev: true,\n    isShowingStats: true,\n    isShowingLables: true,\n    labelsVisibility: {\n        obstacles: false,\n        robots: false\n    },\n    isShowingRobotSnapshots: true,\n    isLoaded: false,\n    isTweening: false,\n    isRotating: false,\n    isMouseMoving: false,\n    isMouseOver: false,\n    maxAnisotropy: 1,\n    dpr: 1,\n    easing: TWEEN.Easing.Quadratic.InOut,\n    duration: 500,\n    texture: {\n        path: './assets/textures/',\n        imageFiles: [{ name: 'UV', image: 'UV_Grid_Sm.jpg' }]\n    },\n    mesh: {\n        enableHelper: false,\n        wireframe: false,\n        translucent: false,\n        material: {\n            color: 0xffffff,\n            emissive: 0xffffff\n        }\n    },\n    fog: {\n        color: 0xffffff,\n        near: 0.0008\n    },\n    camera: {\n        fov: 50,\n        near: 50,\n        far: 1000,\n        aspect: 1,\n        posX: 0,\n        posY: 0,\n        posZ: 0\n    },\n    controls: {\n        autoRotate: false,\n        autoRotateSpeed: -0.5,\n        rotateSpeed: 0.5,\n        zoomSpeed: 0.8,\n        minDistance: 200,\n        maxDistance: 800,\n        minPolarAngle: 0 /*Math.PI / 6,*/,\n        maxPolarAngle: (7 / 16) * Math.PI,\n        minAzimuthAngle: -Infinity,\n        maxAzimuthAngle: Infinity,\n        enableDamping: true,\n        dampingFactor: 0.5,\n        enableZoom: true,\n        target: {\n            x: 0,\n            y: 0,\n            z: 0\n        }\n    },\n    ambientLight: {\n        enabled: true,\n        color: 0x141414\n    },\n    directionalLight: {\n        enabled: true,\n        color: 0xf0f0f0,\n        intensity: 0.4,\n        x: -75,\n        y: 280,\n        z: 150\n    },\n    shadow: {\n        enabled: true,\n        helperEnabled: false,\n        bias: 0,\n        mapWidth: 2048,\n        mapHeight: 2048,\n        near: 250,\n        far: 400,\n        top: 100,\n        right: 100,\n        bottom: -100,\n        left: -100\n    },\n    pointLight: {\n        enabled: true,\n        color: 0xffffff,\n        intensity: 0.34,\n        distance: 115,\n        x: 0,\n        y: 0,\n        z: 0\n    },\n    hemiLight: {\n        enabled: true,\n        color: 0xc8c8c8,\n        groundColor: 0xffffff,\n        intensity: 0.55,\n        x: 0,\n        y: 0,\n        z: 0\n    }\n};\n\n// Check localstorage for updated config, if not use above config\nconst storedConfig = localStorage.getItem(document.location.href + '-vr.config');\nresolvedConfig = storedConfig !== null && storedConfig !== undefined ? JSON.parse(storedConfig) : config;\n\n// method to presist config data with localStorage\nexport const saveConfig = (data) => {\n    localStorage.setItem(document.location.href + '-vr.config', JSON.stringify({ ...config, ...data }));\n};\n\nexport default resolvedConfig;\n","/**\n * @author alteredq / http://alteredqualia.com/\n * @author mr.doob / http://mrdoob.com/\n */\n\nexport default {\n    canvas: !!window.CanvasRenderingContext2D,\n    webgl: (function () {\n        try {\n            var canvas = document.createElement('canvas');\n\n            return !!(\n                window.WebGLRenderingContext &&\n                (canvas.getContext('webgl') || canvas.getContext('experimental-webgl'))\n            );\n        } catch (e) {\n            return false;\n        }\n    })(),\n\n    workers: !!window.Worker,\n    fileapi: window.File && window.FileReader && window.FileList && window.Blob,\n\n    getWebGLErrorMessage: function () {\n        var element = document.createElement('div');\n        element.id = 'webgl-error-message';\n        element.style.fontFamily = 'monospace';\n        element.style.fontSize = '13px';\n        element.style.fontWeight = 'normal';\n        element.style.textAlign = 'center';\n        element.style.background = '#fff';\n        element.style.color = '#000';\n        element.style.padding = '1.5em';\n        element.style.width = '400px';\n        element.style.margin = '5em auto 0';\n\n        if (!this.webgl) {\n            element.innerHTML = window.WebGLRenderingContext\n                ? [\n                      'Your graphics card does not seem to support <a href=\"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation\" style=\"color:#000000\">WebGL</a>.<br />',\n                      'Find out how to get it <a href=\"http://get.webgl.org/\" style=\"color:#000000\">here</a>.'\n                  ].join('\\n')\n                : [\n                      'Your browser does not seem to support <a href=\"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation\" style=\"color:#000000\">WebGL</a>.<br/>',\n                      'Find out how to get it <a href=\"http://get.webgl.org/\" style=\"color:#000000\">here</a>.'\n                  ].join('\\n');\n        }\n\n        return element;\n    },\n\n    addGetWebGLMessage: function (parameters) {\n        var parent, id, element;\n\n        parameters = parameters || {};\n\n        parent = parameters.parent !== undefined ? parameters.parent : document.body;\n        id = parameters.id !== undefined ? parameters.id : 'oldie';\n\n        element = this.getWebGLErrorMessage();\n        element.id = id;\n\n        parent.appendChild(element);\n    }\n};\n","import * as THREE from 'three';\n\nimport Config from '../../data/config';\n\n// Main webGL renderer class\nexport default class Renderer {\n    constructor(scene, container) {\n        // Properties\n        this.scene = scene;\n        this.container = container;\n\n        // Create WebGL renderer and set its antialias\n        this.threeRenderer = new THREE.WebGLRenderer({\n            antialias: true,\n            alpha: true\n        });\n\n        // Set clear color to fog to enable fog or to hex color for no fog\n        //this.threeRenderer.setClearColor(scene.fog.color);\n        this.threeRenderer.setClearColor(new THREE.Color('lightgrey'), 0);\n\n        this.threeRenderer.setPixelRatio(window.devicePixelRatio); // For retina\n\n        this.threeRenderer.setSize(window.innerWidth, window.innerHeight);\n\n        this.threeRenderer.domElement.style.position = 'absolute';\n        this.threeRenderer.domElement.style.top = '0px';\n        this.threeRenderer.domElement.style.left = '0px';\n\n        // Appends canvas\n        container.appendChild(this.threeRenderer.domElement);\n\n        // Shadow map options\n        this.threeRenderer.shadowMap.enabled = true;\n        this.threeRenderer.shadowMap.type = THREE.PCFSoftShadowMap;\n\n        // Get anisotropy for textures\n        Config.maxAnisotropy = this.threeRenderer.capabilities.getMaxAnisotropy();\n\n        // Initial size update set to canvas container\n        this.updateSize();\n\n        // Listeners\n        document.addEventListener('DOMContentLoaded', () => this.updateSize(), false);\n        window.addEventListener('resize', () => this.updateSize(), false);\n    }\n\n    updateSize() {\n        this.threeRenderer.setSize(this.container.offsetWidth, this.container.offsetHeight);\n    }\n\n    render(scene, camera) {\n        // Renders scene to canvas target\n        this.threeRenderer.render(scene, camera);\n    }\n}\n","import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\nimport { CSS2DRenderer, CSS2DObject } from 'three/examples/jsm/renderers/CSS2DRenderer.js';\nimport Config from '../../data/config';\n\nexport default function () {\n    const renderer = new CSS2DRenderer();\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    renderer.domElement.style.position = 'absolute';\n    renderer.domElement.style.top = '0px';\n    renderer.isShowingLables = Config.isShowingLables;\n    renderer.isShowingObstacleLables = Config.labelsVisibility.obstacles;\n    renderer.isShowingRobotLables = Config.labelsVisibility.robots;\n    renderer.updateSize = function () {\n        renderer.setSize(window.innerWidth, window.innerHeight);\n    };\n    document.addEventListener('DOMContentLoaded', () => renderer.updateSize(), false);\n    window.addEventListener('resize', () => renderer.updateSize(), false);\n    return renderer;\n}\n\nexport const addLabel = (prefix, object, mesh, visibility) => {\n    if (mesh !== undefined) {\n        const element = document.createElement('div');\n        element.className = 'label';\n\n        // TODO: use names, insted of IDs\n        element.textContent = object.name;\n\n        element.style.marginTop = '-1.2em';\n        const elementLabel = new CSS2DObject(element);\n        elementLabel.name = `Label[${object.id}]`;\n        elementLabel.position.set(0, 1, 0);\n        elementLabel.visible = visibility;\n        mesh.add(elementLabel);\n        mesh.removeLabel = () => {\n            mesh.remove(elementLabel);\n        };\n    }\n};\n\nexport const removeLabel = (mesh) => {\n    if (mesh !== undefined && mesh.removeLabel !== undefined) {\n        mesh.removeLabel();\n    }\n};\n","import * as THREE from 'three';\n\nimport Config from '../../data/config';\n\n// Sets up and places all lights in scene\nexport default class Light {\n    constructor(scene) {\n        this.scene = scene;\n\n        this.init();\n    }\n\n    init() {\n        // Ambient\n        this.ambientLight = new THREE.AmbientLight(Config.ambientLight.color);\n        this.ambientLight.visible = Config.ambientLight.enabled;\n\n        // Point light\n        this.pointLight = new THREE.PointLight(\n            Config.pointLight.color,\n            Config.pointLight.intensity,\n            Config.pointLight.distance\n        );\n        this.pointLight.position.set(Config.pointLight.x, Config.pointLight.y, Config.pointLight.z);\n        this.pointLight.visible = Config.pointLight.enabled;\n\n        // Directional light\n        this.directionalLight = new THREE.DirectionalLight(\n            Config.directionalLight.color,\n            Config.directionalLight.intensity\n        );\n        this.directionalLight.position.set(\n            Config.directionalLight.x,\n            Config.directionalLight.y,\n            Config.directionalLight.z\n        );\n        this.directionalLight.visible = Config.directionalLight.enabled;\n\n        // Shadow map\n        this.directionalLight.castShadow = Config.shadow.enabled;\n        this.directionalLight.shadow.bias = Config.shadow.bias;\n        this.directionalLight.shadow.camera.near = Config.shadow.near;\n        this.directionalLight.shadow.camera.far = Config.shadow.far;\n        this.directionalLight.shadow.camera.left = Config.shadow.left;\n        this.directionalLight.shadow.camera.right = Config.shadow.right;\n        this.directionalLight.shadow.camera.top = Config.shadow.top;\n        this.directionalLight.shadow.camera.bottom = Config.shadow.bottom;\n        this.directionalLight.shadow.mapSize.width = Config.shadow.mapWidth;\n        this.directionalLight.shadow.mapSize.height = Config.shadow.mapHeight;\n\n        // Shadow camera helper\n        this.directionalLightHelper = new THREE.CameraHelper(this.directionalLight.shadow.camera);\n        this.directionalLightHelper.visible = Config.shadow.helperEnabled;\n\n        // Hemisphere light\n        this.hemiLight = new THREE.HemisphereLight(\n            Config.hemiLight.color,\n            Config.hemiLight.groundColor,\n            Config.hemiLight.intensity\n        );\n        this.hemiLight.position.set(Config.hemiLight.x, Config.hemiLight.y, Config.hemiLight.z);\n        this.hemiLight.visible = Config.hemiLight.enabled;\n    }\n\n    place(lightName) {\n        switch (lightName) {\n            case 'ambient':\n                this.scene.add(this.ambientLight);\n                break;\n\n            case 'directional':\n                this.scene.add(this.directionalLight);\n                this.scene.add(this.directionalLightHelper);\n                break;\n\n            case 'point':\n                this.scene.add(this.pointLight);\n                break;\n\n            case 'hemi':\n                this.scene.add(this.hemiLight);\n                break;\n        }\n    }\n}\n","import Config from '../../data/config';\n\nexport function transformPosition(x, y, z, scale) {\n    const tx = 0.01 * Config.offsets.x + scale * x;\n    const ty = 0.01 * Config.offsets.y + scale * (-y + Math.abs(Config.arena.minY)); // actual Y axis\n    const tz = 0.01 * Config.offsets.z + scale * -z; // actual Z axis\n\n    return { posX: tx, posY: ty, posZ: tz };\n}\nexport function transformScale(scale) {\n    return { scaleX: scale, scaleY: scale, scaleZ: scale };\n}\n\nexport function transformRotation(x, y, z) {\n    return { rotX: x - Math.PI / 2, rotY: y, rotZ: z };\n}\n","// Local vars for rStats\nlet rS, bS, glS, tS;\n\nexport default class Stats {\n    constructor(renderer) {\n        this.renderer = renderer;\n    }\n\n    setUp() {\n        bS = new BrowserStats();\n        glS = new glStats();\n        tS = new threeStats(this.renderer);\n\n        rS = new rStats({\n            CSSPath: './css/',\n            userTimingAPI: true,\n            values: {\n                frame: {\n                    caption: 'Total frame time (ms)',\n                    over: 16,\n                    average: true,\n                    avgMs: 100\n                },\n                fps: { caption: 'Framerate (FPS)', below: 30 },\n                calls: { caption: 'Calls (three.js)', over: 3000 },\n                raf: { caption: 'Time since last rAF (ms)', average: true, avgMs: 100 },\n                rstats: { caption: 'rStats update (ms)', average: true, avgMs: 100 },\n                texture: { caption: 'GenTex', average: true, avgMs: 100 }\n            },\n            groups: [\n                { caption: 'Framerate', values: ['fps', 'raf'] },\n                {\n                    caption: 'Frame Budget',\n                    values: ['frame', 'texture', 'setup', 'render']\n                }\n            ],\n            fractions: [{ base: 'frame', steps: ['texture', 'setup', 'render'] }],\n            plugins: [bS, tS]\n        });\n    }\n\n    static start() {\n        rS('frame').start();\n        glS.start();\n\n        rS('rAF').tick();\n        rS('FPS').frame();\n\n        rS('render').start();\n    }\n\n    static end() {\n        rS('render').end(); // render finished\n        rS('frame').end(); // frame finished\n\n        // Local rStats update\n        rS('rStats').start();\n        rS().update();\n        rS('rStats').end();\n    }\n}\n","import * as THREE from 'three';\n\nimport Config from '../../data/config';\nimport { transformPosition, transformScale, transformRotation } from '../helpers/coordinateTransform';\n\nexport default class Environment {\n    constructor() {\n        console.log(`Environment: Scale: ${scene_scale}, arenaSize:${Config.arena.size}`);\n\n        var geometry = new THREE.PlaneBufferGeometry(Config.arena.size, Config.arena.size);\n        var material = new THREE.MeshStandardMaterial({\n            color: 0x999999,\n            depthWrite: false,\n            opacity: 0\n        });\n\n        const { posX, posY, posZ } = transformPosition(0, 0, 0, scene_scale);\n        const { rotX, rotY, rotZ } = transformRotation(0, 0, 0);\n        const { scaleX, scaleY, scaleZ } = transformScale(scene_scale);\n\n        // Ground\n        // var ground = new THREE.Mesh(geometry, material);\n        // ground.rotation.set(rotX - Math.PI / 2, rotY, rotZ);\n        // ground.position.set(posX, posY, posZ);\n        // ground.scale.set(scaleX, scaleY, scaleZ);\n        // // ground.material.opacity = 0.05;\n        // ground.receiveShadow = true;\n        // markerGroup.add(ground);\n\n        // Grid\n        var grid = new THREE.GridHelper(Config.arena.size, 18, 0x000000, 0x5b5b5b);\n        grid.rotation.set(rotX, rotY, rotZ);\n        grid.position.set(posX, posY, posZ);\n        grid.scale.set(scaleX, scaleY, scaleZ);\n        grid.material.opacity = 0.15;\n        // grid.material.transparent = true;\n        markerGroup.add(grid);\n\n        // Zero marker\n        const zeroGeometry = new THREE.SphereGeometry(5, 16, 16);\n        const zeroMarker = new THREE.Mesh(zeroGeometry, new THREE.MeshBasicMaterial({ color: 0xffff00 }));\n        zeroMarker.name = 'zeroMarker';\n        zeroMarker.scale.set(scene_scale, scene_scale, scene_scale);\n        zeroMarker.visible = Config.offsets.showZeroMarker;\n        markerGroup.add(zeroMarker);\n        window.zeroMarker = zeroMarker;\n\n        const markerGeometry = new THREE.SphereGeometry(2.5, 16, 16);\n        const coordMarker = new THREE.Mesh(markerGeometry, new THREE.MeshBasicMaterial({ color: 0xff0000 }));\n        coordMarker.name = 'coordinateMarker';\n        coordMarker.position.set(posX, posY, posZ);\n        coordMarker.scale.set(scene_scale, scene_scale, scene_scale);\n        coordMarker.visible = Config.offsets.showCoordMarker;\n        markerGroup.add(coordMarker);\n        window.coordMarker = coordMarker;\n    }\n}\n","import Config, { saveConfig } from '../../data/config';\nimport { transformPosition, transformScale, transformRotation } from '../helpers/coordinateTransform';\n\n// Manages all dat.GUI interactions\nexport default class DatGUI {\n    constructor(main) {\n        this.gui = new dat.GUI();\n        this.gui.useLocalStorage = true;\n    }\n\n    load(main, mesh) {\n        const offsetRange = parseInt(Config.offsets.scaleRange);\n\n        // ---------------------------------------------------------------------\n        // Robot Snapshots\n        // this.gui\n        // .add(Config, 'isShowingRobotSnapshots')\n        // .name('Robot Snapshots')\n        // .onChange((value) => {\n        //     Config.isShowingRobotSnapshots = value;\n        //     saveConfig(Config);\n        // });\n\n        // ---------------------------------------------------------------------\n        // labelsFolder\n\n        // const labelsFolder = this.gui.addFolder('Labels');\n        // labelsFolder\n        // .add(Config, 'isShowingLables')\n        // .name('All Labels')\n        // .onChange((value) => {\n        //     Config.isShowingLables = value;\n        //     Config.labelsVisibility = {\n        //         obstacles: value,\n        //         robots: value\n        //     };\n        //     saveConfig(Config);\n        // });\n        // .add(Config.labelsVisibility, 'obstacles')\n        // .name('Obstacle Labels')\n        // .onChange((value) => {\n        //     // this.toggleLabels(this.scene.children, 'Obstacle', value);\n        //     // alert('Obstacle Label');\n        //     this.toggleLabels(window.markerGroup.children, 'Obstacle', value);\n        // });\n        // labelsFolder\n        // .add(Config.labelsVisibility, 'robots')\n        // .name('Robot Labels')\n        // .onChange((value) => {\n        //     // this.toggleLabels(this.scene.children, 'Robot', value);\n        //     // alert('Robot Label');\n        //     this.toggleLabels(window.markerGroup.children, 'Robot', value);\n        // });\n\n        // ---------------------------------------------------------------------\n        /* Reality Folder */\n        const realityFolder = this.gui.addFolder('Reality');\n\n        realityFolder\n            .add(Config.selectedRealities, 'real')\n            .name('Physical Reality')\n            .listen()\n            .onChange((value) => {\n                this.toggleReality('real', 'R');\n                saveConfig(Config);\n            });\n        realityFolder\n            .add(Config.selectedRealities, 'virtual')\n            .name('Virtual Reality')\n            .listen()\n            .onChange((value) => {\n                this.toggleReality('virtual', 'V');\n                saveConfig(Config);\n            });\n\n        // ---------------------------------------------------------------------\n        const placeFolder = this.gui.addFolder('Placement');\n\n        // Toggle visibility of Zero marker (yellow)\n        placeFolder\n            .add(Config.offsets, 'showZeroMarker')\n            .name('Zero Marker')\n            .listen()\n            .onChange((value) => {\n                saveConfig(Config);\n                window.zeroMarker.visible = value;\n            });\n\n        // Toggle visibility of Coord marker (red)\n        placeFolder\n            .add(Config.offsets, 'showCoordMarker')\n            .name('Coordinate Marker')\n            .listen()\n            .onChange((value) => {\n                saveConfig(Config);\n                window.coordMarker.visible = value;\n            });\n        // ---------------------------------------------------------------------\n        // X Offset\n        placeFolder\n            .add(Config.offsets, 'x')\n            .min(-1 * parseInt(360))\n            .max(parseInt(360))\n            .name('X Offset')\n            .listen()\n            .onChange((value) => {\n                Config.offsets.x = value;\n                this.updateCoord();\n                saveConfig(Config);\n            });\n        // Y Offset\n        placeFolder\n            .add(Config.offsets, 'y')\n            .min(-1 * parseInt(360))\n            .max(parseInt(360))\n            .name('Y Offset')\n            .listen()\n            .onChange((value) => {\n                Config.offsets.y = value;\n                this.updateCoord();\n                saveConfig(Config);\n            });\n        // Z Offset\n        placeFolder\n            .add(Config.offsets, 'z')\n            .min(-1 * parseInt(500))\n            .max(parseInt(500))\n            .name('Z Offset')\n            .listen()\n            .onChange((value) => {\n                Config.offsets.z = value;\n                this.updateCoord();\n                saveConfig(Config);\n            });\n        // Scale Offset\n        placeFolder\n            .add(Config, 'scale', 0, 0.1)\n            .name('Scale')\n            .listen()\n            .onChange((value) => {\n                Config.offsets.scale = value;\n                window.coordMarker.scale.set(value, value, value);\n                saveConfig(Config);\n            });\n\n        /* Global */\n        this.gui.open();\n        // this.gui.close();\n    }\n\n    toggleLabels(objects, type, value) {\n        saveConfig(Config);\n        if (Array.isArray(objects) && type !== undefined && type !== '') {\n            for (var variable of objects) {\n                if (variable.name.startsWith(type)) {\n                    variable.children[0].visible = value;\n                }\n            }\n        }\n    }\n\n    toggleReality(reality, selected) {\n        // by default visualizer will intercept all the communication coming to the channel regardless of the reality.\n        // this control panel will only toggle the 'visibility' of objects in the selected realities.\n        const objects = window.markerGroup.children;\n\n        saveConfig(Config);\n        Object.entries(objects).forEach((obj) => {\n            const name = obj[1]['name'];\n            const reality = obj[1]['reality'];\n\n            if (reality !== undefined && reality === 'R') {\n                // obj[1].transparent = Config.selectedRealities.real;\n                obj[1].material.opacity = Config.selectedRealities.real ? 1.0 : Config.hiddenOpacity;\n            } else if (reality !== undefined && reality === 'V') {\n                // obj[1].transparent = Config.selectedRealities.virtual;\n                obj[1].material.opacity = Config.selectedRealities.virtual ? 1.0 : Config.hiddenOpacity;\n            }\n        });\n    }\n\n    updateCoord() {\n        const pos = window.coordMarker.position;\n        const { posX, posY, posZ } = transformPosition(pos.x, pos.y, pos.z, scene_scale);\n        window.coordMarker.position.set(posX, posY, posZ);\n    }\n\n    unload() {\n        this.gui.destroy();\n        this.gui = new dat.GUI();\n    }\n}\n","import * as THREE from 'three';\n\nimport Config from '../../data/config';\nimport { addLabel, removeLabel } from './label';\nimport { transformPosition, transformScale, transformRotation } from '../helpers/coordinateTransform';\n\nconst OBSTACLE_PREFIX = 'Obstacle_';\n\nexport default class Obstacle {\n    constructor(scene, callback) {\n        this.scene = scene;\n        this.scale = scene_scale;\n\n        console.log('Obstacle Reality:', Config.mixedReality.obstacles);\n\n        if (callback !== undefined) callback();\n    }\n\n    // Create a given list of obstacles\n    createList(obstacles) {\n        Object.entries(obstacles).forEach((obs) => {\n            if (obs !== undefined) {\n                this.create(obs[1]);\n            }\n        });\n    }\n\n    // Create a obstacle\n    create(obstacle) {\n        const geometry = this.createGeometry(obstacle.geometry);\n        const material = this.createMaterial(obstacle.material);\n\n        material.userData.originalColor = new THREE.Color(0x666666);\n        material.userData.labelVisibility = Config.isShowingLables && Config.labelsVisibility.obstacles;\n        material.userData.originalEmmisive = material.emissive.getHex();\n        material.selected = false;\n        material.transparent = true;\n\n        const id = obstacle.id || 1000 + Math.floor(900 * Math.random());\n        const reality = obstacle.reality == undefined ? 'V' : obstacle.reality;\n        const mesh = new THREE.Mesh(geometry, material);\n\n        // TODO: add the name defined in env.config.json as discussed on 2021-02-18\n        //      Need some obstacle protocol revision + simulator updates\n        const name_temp = 'Obs_' + id.toString().substring(0, 8) + '...';\n\n        mesh.name = OBSTACLE_PREFIX + id;\n        mesh.reality = reality; // set reality flag\n\n        if (mesh.reality === 'V') {\n            material.opacity = Config.selectedRealities.virtual ? 1.0 : Config.hiddenOpacity;\n        } else if (mesh.reality === 'R') {\n            material.opacity = Config.selectedRealities.real ? 1.0 : Config.hiddenOpacity;\n        }\n\n        // Remove if object is already defined\n        this.deleteIfExists(id);\n\n        // Add the mesh object to arena\n        window.markerGroup.add(mesh);\n\n        // update the position of the object\n        if (obstacle.position !== undefined) {\n            const { x, y } = obstacle.position;\n            const z = this.calculateZ(obstacle);\n\n            const { posX, posY, posZ } = transformPosition(x, y, z, this.scale);\n            const { scaleX, scaleY, scaleZ } = transformScale(this.scale);\n\n            mesh.position.set(posX, posY, posZ);\n            mesh.scale.set(scaleX, scaleY, scaleZ);\n        }\n\n        // Rotate the object, after translate degrees into radians\n        if (obstacle.rotation != undefined) {\n            const { x, y, z } = obstacle.rotation;\n            const radX = (x / 360) * 2 * Math.PI; // transformation due to coordinate system\n            const radY = (y / 360) * 2 * Math.PI;\n            const radZ = (z / 360) * 2 * Math.PI;\n\n            const { rotX, rotY, rotZ } = transformRotation(radX, radY, radZ);\n            mesh.rotation.set(rotX, rotY, rotZ);\n        }\n\n        // Show shadows of the object if enabled\n        if (Config.shadow.enabled) mesh.receiveShadow = true;\n\n        // Add labels to every obstacle, immediately displayed if enabled\n        addLabel(OBSTACLE_PREFIX, { id: obstacle.id, name: name_temp }, mesh, Config.labelsVisibility.obstacles);\n\n        console.log('Created>', mesh.name);\n    }\n\n    createGeometry(g) {\n        if (g.type == undefined) throw new TypeError('type unspecified');\n\n        if (g.type == 'BoxGeometry') {\n            return this.createBoxGeometry(g.width, g.height, g.depth);\n        } else if (g.type == 'CylinderGeometry') {\n            return this.createCylinderGeometry(g.radiusTop, g.radiusBottom, g.height);\n        } else if (g.type == 'SphereGeometry') {\n            return this.createSphereGeometry(g.radius);\n        }\n        throw new TypeError('unsupported geometry type');\n    }\n\n    createBoxGeometry(width, height, depth) {\n        if (width == undefined) throw new TypeError('width unspecified');\n        if (height == undefined) throw new TypeError('height unspecified');\n        if (depth == undefined) throw new TypeError('depth unspecified');\n\n        // https://threejs.org/docs/#api/en/geometries/BoxGeometry\n        return new THREE.BoxGeometry(width, height, depth);\n    }\n\n    createCylinderGeometry(radiusTop, radiusBottom, height) {\n        if (radiusTop == undefined) throw new TypeError('radiusTop unspecified');\n        if (radiusBottom == undefined) throw new TypeError('radiusBottom unspecified');\n        if (height == undefined) throw new TypeError('height unspecified');\n\n        // https://threejs.org/docs/#api/en/geometries/CylinderGeometry\n        const heightSegments = heightSegments || 2;\n        const radialSegments = radialSegments || 16;\n\n        return new THREE.CylinderGeometry(radiusTop, radiusBottom, height, radialSegments, heightSegments);\n    }\n\n    createSphereGeometry(radius) {\n        if (radius == undefined) throw new TypeError('radius unspecified');\n\n        // https://threejs.org/docs/#api/en/geometries/SphereGeometry\n        const widthSegments = widthSegments || 16;\n        const heightSegments = heightSegments || 16;\n        return new THREE.SphereGeometry(radius, widthSegments, heightSegments);\n    }\n\n    createMaterial(m) {\n        if (m.type == 'MeshBasicMaterial') {\n            // https://threejs.org/docs/#api/en/materials/MeshBasicMaterial\n            return new THREE.MeshBasicMaterial(m.properties);\n        } else if (m.type == 'MeshNormalMaterial') {\n            // https://threejs.org/docs/api/en/materials/MeshNormalMaterial.html\n            return new THREE.MeshNormalMaterial(m.properties);\n        } else if (m.type == 'MeshPhongMaterial') {\n            // https://threejs.org/docs/#api/en/materials/MeshPhongMaterial\n            return new THREE.MeshPhongMaterial(m.properties);\n        } else if (m.type == 'MeshPhysicalMaterial') {\n            // https://threejs.org/docs/#api/en/materials/MeshPhysicalMaterial\n            return new THREE.MeshPhysicalMaterial(m.properties);\n        } else if (m.type == 'MeshStandardMaterial') {\n            // https://threejs.org/docs/#api/en/materials/MeshStandardMaterial\n            return new THREE.MeshStandardMaterial(m.properties);\n        }\n        // Default material type\n        return new THREE.MeshStandardMaterial(m.properties);\n    }\n\n    calculateZ(obstacle) {\n        // If z is undefined, place the object in top of the arena\n        if (obstacle.position.z == undefined) {\n            if (obstacle.geometry.height !== undefined) {\n                // Box and Cylinder objects\n                return obstacle.geometry.height / 2;\n            } else if (obstacle.geometry.radius !== undefined) {\n                // Sphere objects\n                return obstacle.geometry.radius;\n            }\n            return 0;\n        }\n        return obstacle.position.z;\n    }\n\n    deleteIfExists(id) {\n        // Delete obstacle if it already exists\n\n        const name = OBSTACLE_PREFIX + id;\n        const obstacle = window.markerGroup.getObjectByName(name);\n\n        if (obstacle !== undefined) {\n            window.markerGroup.remove(obstacle);\n            removeLabel(obj[1]);\n            console.log('Deleted>', name);\n        }\n    }\n\n    deleteAll() {\n        // Delete all obstacles\n        const objects = window.markerGroup.children;\n\n        Object.entries(objects).forEach((obj) => {\n            const name = obj[1]['name'];\n\n            if (name.startsWith(OBSTACLE_PREFIX)) {\n                console.log('Deleted>', name);\n                window.markerGroup.remove(obj[1]);\n            }\n        });\n    }\n}\n","import * as THREE from 'three';\nimport TWEEN, { update } from '@tweenjs/tween.js';\n\nimport Config from '../../data/config';\nimport { addLabel, removeLabel } from './label';\nimport { transformPosition, transformScale, transformRotation } from '../helpers/coordinateTransform';\n\nvar STLLoader = require('three-stl-loader')(THREE);\n\nconst ROBOT_PREFIX = 'Robot_';\n\nexport default class Robot {\n    constructor(scene) {\n        this.scene = scene;\n        this.scale = Config.scale;\n        console.log('Robot Reality:', Config.mixedReality.robots);\n\n        // This will check for duplicated instances of robots and delete them\n        const that = this;\n        this.created = true;\n        setInterval(() => {\n            if (this.created === true) {\n                // console.log('call prune');\n                that.prune();\n                this.created = false;\n            }\n        }, 2500);\n    }\n\n    create(id, x, y, heading, reality = 'V', callback) {\n        var r = window.markerGroup.getObjectByName(ROBOT_PREFIX + id);\n        const REALITY = Config.mixedReality.robots;\n\n        if (r === undefined) {\n            // Create only if not exists\n\n            if (reality === REALITY || REALITY === 'M') {\n                // Limit the arena that robot can go\n                x = Math.min(Math.max(x, Config.arena.minX), Config.arena.maxX);\n                y = Math.min(Math.max(y, Config.arena.minY), Config.arena.maxY);\n                var loader = new STLLoader();\n\n                loader.load('./assets/models/model.stl', function (geometry, scene) {\n                    const material = new THREE.MeshStandardMaterial({\n                        color: 0x666666,\n                        transparent: true\n                    });\n                    material.userData.originalColor = new THREE.Color(0x666666);\n                    material.userData.labelVisibility = Config.isShowingLables && Config.labelsVisibility.robots;\n                    material.selected = false;\n\n                    const scale = Config.scale || 0.1;\n\n                    const { posX, posY, posZ } = transformPosition(x, y, 0, scale);\n                    const { rotX, rotY, rotZ } = transformRotation(0, 0, 0);\n                    const { scaleX, scaleY, scaleZ } = transformScale(scale);\n\n                    var r = new THREE.Mesh(geometry, material);\n                    r.receiveShadow = true;\n                    r.robotId = id;\n                    r.name = ROBOT_PREFIX + id;\n                    r.scale.set(scaleX, scaleY, scaleZ);\n                    r.position.set(posX, posY, posZ);\n                    r.rotation.set(rotX, rotY, rotZ);\n                    r.reality = reality; // set reality flag\n\n                    if (reality === 'V') {\n                        material.opacity = Config.selectedRealities.virtual ? 1.0 : Config.hiddenOpacity;\n                    } else if (reality === 'R') {\n                        material.opacity = Config.selectedRealities.real ? 1.0 : Config.hiddenOpacity;\n                    }\n\n                    window.markerGroup.add(r);\n\n                    r.clickEvent = function (m) {\n                        window.robot.alert(m);\n                    };\n\n                    // Add labels to every robot, immediately displayed if enabled\n                    addLabel(ROBOT_PREFIX, { id, name: r.name }, r, Config.labelsVisibility.robots);\n\n                    console.log(`Created> Robot: id:${id} | x:${x} y: ${y} heading: ${heading} | reality: ${reality}`);\n\n                    // Callback function\n                    if (callback !== undefined) callback('success');\n                });\n            } else {\n                console.error(`Creation Failed> Robot: id:${id}  reality: ${reality}!=${REALITY}`);\n            }\n        } else if (reality === REALITY || REALITY === 'M') {\n            // Reality matches\n            this.setReality(id, reality);\n            if (callback !== undefined) callback('success');\n        } else {\n            // Robot reality not matching with environment reality\n            this.delete(id);\n            if (callback !== undefined) callback('deleted');\n        }\n\n        this.created = true; // asked to prune in next cycle\n        return r;\n    }\n\n    setReality(id, reality) {\n        var r = this.scene.getObjectByName(ROBOT_PREFIX + id);\n        if (r != undefined) {\n            r.reality = reality;\n        }\n    }\n\n    exists(id) {\n        return window.markerGroup.getObjectByName(ROBOT_PREFIX + id);\n    }\n\n    delete(id, callback) {\n        if (id !== undefined) {\n            var r = window.markerGroup.getObjectByName(ROBOT_PREFIX + id);\n\n            if (r !== undefined) {\n                scene.remove(r);\n                console.log('Deleted> id:', id);\n                removeLabel(obj[1]);\n                if (callback !== undefined) callback('success');\n            } else if (callback !== undefined) callback('not found');\n        }\n    }\n\n    deleteAll() {\n        // Delete all robots\n        const objects = window.markerGroup.children;\n\n        Object.entries(objects).forEach((obj) => {\n            const name = obj[1]['name'];\n\n            if (name.startsWith(ROBOT_PREFIX)) {\n                console.log('Deleted>', name);\n                removeLabel(obj[1]);\n                window.markerGroup.remove(obj[1]);\n            }\n        });\n    }\n\n    move(id, x, y, heading, callback) {\n        var r = window.markerGroup.getObjectByName(ROBOT_PREFIX + id);\n        if (r !== undefined) {\n            const currentHeading = r.rotation.y;\n            const newHeading = (heading - 90) * THREE.Math.DEG2RAD;\n            var position = { x: r.position.x, y: r.position.y, heading: r.rotation.y };\n\n            // TODO: need a smoother way than this rough trick\n            // If current and target rotations in different signs\n            const rotationFlag = currentHeading * newHeading >= 0 ? true : false;\n\n            // Limit the arena that robot can go\n            x = Math.min(Math.max(Math.round(x * 10) / 10, Config.arena.minX), Config.arena.maxX);\n            y = Math.min(Math.max(Math.round(y * 10) / 10, Config.arena.minY), Config.arena.maxY);\n            heading = Math.round(heading * 10) / 10;\n\n            const { posX, posY, posZ } = transformPosition(x, y, 0, Config.scale);\n            const { rotX, rotY, rotZ } = transformRotation(0, 0, 0);\n\n            // const speed = 10;\n            const distance = Math.sqrt(Math.pow(posX - position.x, 2) + Math.pow(posY - position.y, 2));\n\n            const moveTime = 1; // (distance / speed);\n\n            if (distance !== 0) {\n                var tween = new TWEEN.Tween(position)\n                    .to({ x: posX, y: posY, heading: newHeading }, 1000 * moveTime)\n                    .onUpdate(function () {\n                        r.position.x = position.x;\n                        r.position.y = position.y;\n\n                        if (rotationFlag) {\n                            r.rotation.y = position.heading;\n                        } else {\n                            //console.log(currentHeading, newHeading);\n                        }\n                    })\n                    .onComplete(() => {\n                        //console.log('Moved> id:',id,'x:',x,'y:',y,'heading:',heading);\n                        r.rotation.y = position.heading;\n                        if (callback != null) callback('success');\n                    })\n                    .delay(50)\n                    .start();\n            } else {\n                // No move, only the rotation\n                r.rotation.y = newHeading;\n            }\n            return r;\n        }\n        if (callback != null) callback('undefined');\n    }\n\n    get_coordinates(id) {\n        var r = window.markerGroup.getObjectByName(ROBOT_PREFIX + id);\n        if (r !== undefined) {\n            console.log(`${r.position.x},${r.position.y},${r.position.z}`);\n            return { x: r.position.x, y: r.position.y, z: r.position.z, heading: r.rotation.y };\n        }\n        return null;\n    }\n\n    changeColor(id, R, G, B, callback) {\n        var r = window.markerGroup.getObjectByName(ROBOT_PREFIX + id);\n        if (r !== undefined) {\n            r.material.color.setRGB(R / 256, G / 256, B / 265);\n            if (callback !== null) callback('success');\n            return r;\n        }\n\n        if (callback !== null) callback('undefined');\n        return null;\n    }\n\n    update() {\n        TWEEN.update();\n    }\n\n    requestSnapshot(mesh) {\n        return new Promise((resolve, reject) => {\n            const req = window.mqtt.publish(\n                window.channel + '/mgt/robots/snapshot',\n                JSON.stringify({ id: mesh.robotId })\n            );\n            resolve(!req);\n        });\n    }\n\n    alert(mesh) {\n        // Display an alert on window\n        const disp = document.querySelector('#msg-box');\n        const prevContent = document.getElementById('msg-content');\n        const content = document.createElement('div');\n        content.setAttribute('id', 'msg-content');\n        let nodeContent;\n        if (Config.isShowingRobotSnapshots) {\n            nodeContent = document.createTextNode(`${mesh.name} Snapshot Loading...`);\n            this.requestSnapshot(mesh);\n        } else {\n            nodeContent = document.createTextNode(`${mesh.name}`);\n        }\n        content.appendChild(nodeContent);\n        disp.replaceChild(content, prevContent);\n        disp.style.display = 'block';\n        setTimeout(function () {\n            disp.style.opacity = '1.0';\n            disp.style.display = 'none';\n        }, 10000);\n    }\n\n    prune() {\n        // Delete all duplicate robots\n        const objects = window.markerGroup.children;\n        const valid = [];\n        Object.entries(objects).forEach((obj) => {\n            const name = obj[1]['name'];\n\n            if (name.startsWith(ROBOT_PREFIX)) {\n                if (valid[name] === undefined) {\n                    valid[name] = 'valid';\n                } else {\n                    // this is a duplicate\n                    removeLabel(obj[1]);\n                    this.scene.remove(obj[1]);\n                    // console.log(name, ': duplicate');\n                }\n            }\n        });\n    }\n}\n","const jwt = require('jsonwebtoken');\n\nfunction getUrlVars() {\n    var vars = {};\n    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (m, key, value) {\n        vars[key] = value;\n    });\n    return vars;\n}\n\nfunction getUrlParam(parameter, defaultvalue) {\n    var urlparameter = defaultvalue;\n    if (window.location.href.indexOf(parameter) > -1) {\n        urlparameter = getUrlVars()[parameter];\n    }\n    return urlparameter;\n}\n\nexport function getCredentials() {\n    const storedCredentials = localStorage.getItem('pera-swarm-credentials');\n    const key = getUrlParam('key', false);\n\n    const username = getUrlParam('username', false);\n    const password = getUrlParam('password', false);\n    const channel = getUrlParam('channel', false);\n    const port = getUrlParam('port', false);\n    const server = getUrlParam('server', false);\n    clearParams();\n\n    setTimeout(() => {\n        if (server !== false) {\n            localStorage.setItem('pera-swarm-server', server);\n        }\n        if (channel !== false) {\n            localStorage.setItem('pera-swarm-channel', channel);\n        }\n        if (port !== false) {\n            localStorage.setItem('pera-swarm-port', port);\n        }\n        if (key !== false) {\n            localStorage.setItem('pera-swarm-key', key);\n        }\n    }, 2000);\n\n    // Load the credentails\n    if (key !== false) {\n        // Having JWT Token\n        // TODO: manage token expiring\n\n        // Default: eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJjcmVhdGVkQXQiOiIyMDIxLTA0LTE1IDEyOjU0OjI0IiwiZXhwaXJlZEF0IjoiMjAyMS0wNC0xNSAwMTo1NDoyNCIsImhvc3QiOiJ3ZWJzZXJ2aWNlcy5jZXlrb2QuY29tIiwicG9ydCI6ODg4MywicGF0aCI6IlwvbXF0dCIsImNoYW5uZWwiOiJ2MSIsInVzZXIiOiJzd2FybV91c2VyIiwicGFzcyI6InN3YXJtX3VzZXJlMTUifQ.F1jqHyu1jE0zTa03yYTwwdy8AJofBLXWLvYMYLNlna6dUjTkz6WdtwjBcrF_zDARM95r67RykOiWJCHDiWM52MQFx3EivqTYUNnA5fyNfsdJgrBR0q7eESM28MTSFoxnVi7memIKCSnkju3qDRZuZZdB5jaLP2BYg7ipgEFzt7E\n        console.log('Credentails: Loaded from JWT');\n\n        const credentials = parseJwt(key);\n        const username = credentials.user;\n        const password = credentials.pass;\n        const channel = credentials.channel;\n\n        if (credentials.host !== undefined) localStorage.setItem('pera-swarm-server', credentials.host);\n        if (credentials.port !== undefined) localStorage.setItem('pera-swarm-port', parseInt(credentials.port));\n        if (credentials.path !== undefined) localStorage.setItem('pera-swarm-path', credentials.path);\n        if (credentials.channel !== undefined) localStorage.setItem('pera-swarm-channel', credentials.channel);\n\n        localStorage.setItem('pera-swarm-credentials', JSON.stringify({ username, password, channel }));\n\n        return {\n            username,\n            password,\n            channel\n        };\n    } else if (username !== false && password !== false) {\n        // Having URL parameters\n        console.log('Credentails: Loaded from URL parameters');\n        localStorage.setItem('pera-swarm-credentials', JSON.stringify({ username, password, channel }));\n        return {\n            username,\n            password,\n            channel\n        };\n    } else if (username === false && password === false && storedCredentials !== null) {\n        // Having stored credentials\n        console.log('Credentails: Loaded from local storage');\n        return JSON.parse(storedCredentials);\n    }\n    return -1;\n}\n\nfunction parseJwt(token) {\n    var base64Url = token.split('.')[1];\n    var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n    var jsonPayload = decodeURIComponent(\n        atob(base64)\n            .split('')\n            .map(function (c) {\n                return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n            })\n            .join('')\n    );\n\n    return JSON.parse(jsonPayload);\n}\n\nfunction clearParams() {\n    const path = window.location.origin + window.location.pathname;\n    window.history.pushState({}, document.title, path);\n}\n\nfunction decodeKey() {\n    try {\n        const decoded = jwt.verify(token, 'swarm-visualizer-secret');\n        return decoded;\n    } catch (err) {\n        // err\n        console.log('Token Error');\n        return -1;\n    }\n}\n","import Config from '../../data/config';\nimport MQTT from 'paho-mqtt';\n\nimport Obstacle from '../components/obstacle';\nimport Robot from '../components/robot';\n\nimport { getCredentials } from '../helpers/urlHelper';\n\n// -----------------------------------------------------------------------------\n// MQTT Topics\n// -----------------------------------------------------------------------------\n// This will provide location data to the GUI\nconst TOPIC_LOC_INFO = 'localization/info';\n\n// Create and delete robot objects\nconst TOPIC_ROBOT_CREATE = 'robot/create';\nconst TOPIC_ROBOT_DELETE = 'robot/delete';\nconst TOPIC_ROBOT_BROADCAST = 'robot/msg/broadcast';\n\n// This will provide location data to the GUI\nconst TOPIC_LOC_INFO_FROM_SERVER = 'localization/data';\nconst TOPIC_LOC_INFO_FROM_LOC_SYSTEMS = 'localization/update';\n\n// This will request the localization data update from the server\nconst TOPIC_LOC_REQUEST = 'localization/data/?';\n\n// This will request obstacle data from the server\nconst TOPIC_OBSTACLE_REQUEST = 'obstacles/?';\n\n// This will send obstacle data as a JSON list\nconst TOPIC_OBSTACLES_LIST = 'obstacles';\nconst TOPIC_OBSTACLES_DELETE = 'obstacles/delete';\nconst TOPIC_OBSTACLES_DELETE_ALL = 'obstacles/delete/all';\n\nconst TOPIC_CHANGE_COLOR = 'output/neopixel';\n\n// This will help to remote update the parameters in here\nconst TOPIC_MANAGEMENT_VISUALIZER = 'mgt/visualizer';\n\n// Robot management snapshot topic\nconst TOPIC_MANAGEMENT_SNAPSHOT = 'mgt/robots/?';\n\n// -----------------------------------------------------------------------------\n\nexport default class MQTTClient {\n    constructor(scene, markerGroup) {\n        this.markerGroup = markerGroup;\n        this.scene = scene;\n        this.robot = new Robot(scene);\n        this.obstacles = new Obstacle(scene);\n\n        this.updateChannel();\n        const credentials = getCredentials();\n\n        if (credentials === -1) {\n            alert('Unauthorized access! The Visualizer will not work properly.');\n        } else {\n            const { username, password } = credentials;\n            // create a random client Id\n            const clientId = 'client_' + Math.random().toString(36).substring(2, 15);\n            this.client = new MQTT.Client(Config.mqtt.server, Config.mqtt.port, Config.mqtt.path, clientId);\n\n            window.mqtt = this.client;\n\n            this.client.connect({\n                userName: username,\n                password: password,\n                reconnect: true,\n                useSSL: true,\n                cleanSession: false,\n                onSuccess: () => {\n                    console.log('MQTT: connected');\n\n                    // Subscribe to topics\n                    this.subscribe(TOPIC_LOC_INFO_FROM_SERVER);\n                    this.subscribe(TOPIC_LOC_INFO_FROM_LOC_SYSTEMS);\n\n                    this.subscribe(TOPIC_ROBOT_CREATE);\n                    this.subscribe(TOPIC_ROBOT_DELETE);\n                    this.subscribe(TOPIC_ROBOT_BROADCAST);\n\n                    this.subscribe(TOPIC_CHANGE_COLOR);\n                    this.subscribe(TOPIC_OBSTACLES_LIST);\n                    this.subscribe(TOPIC_OBSTACLES_DELETE);\n                    this.subscribe(TOPIC_OBSTACLES_DELETE_ALL);\n                    this.subscribe(TOPIC_MANAGEMENT_VISUALIZER);\n                    this.subscribe(TOPIC_MANAGEMENT_SNAPSHOT);\n\n                    // Request for obstacle data\n                    this.publish(TOPIC_OBSTACLE_REQUEST, Config.mixedReality.obstacles);\n\n                    // Request for coordinate data\n                    this.publish(TOPIC_LOC_REQUEST, Config.mixedReality.robots);\n\n                    // Access globally\n                    window.robot = this.robot;\n                    window.obstacles = this.obstacles;\n\n                    this.client.onMessageArrived = this.onMessageArrived;\n                    this.client.onConnectionLost = this.onConnectionLost;\n                },\n                onFailure: () => {\n                    console.log('MQTT: connection failed');\n                    alert('MQTT: connection failed!');\n                }\n            });\n        }\n    }\n\n    updateChannel() {\n        const channelHash = window.location.hash;\n        if ((channelHash != '') & (channelHash.length > 1)) {\n            window.channel = channelHash.split('#')[1].split('?')[0];\n        } else {\n            window.channel = Config.mqtt.channel;\n        }\n        console.log('MQTT: channel=', window.channel, channelHash);\n        return true;\n    }\n\n    onConnectionLost(responseObject) {\n        if (responseObject.errorCode !== 0) {\n            console.log('MQTT: onConnectionLost:' + responseObject.errorMessage);\n            console.log('MQTT: reconnecting');\n        }\n    }\n\n    onMessageArrived(packet) {\n        const msg = packet.payloadString.trim();\n        const t = packet.destinationName;\n        const topic = t.substring(t.indexOf('/') + 1);\n\n        // console.log('MQTT: ' + topic + ' > ' + msg);\n\n        if (topic == TOPIC_ROBOT_CREATE) {\n            try {\n                const data = JSON.parse(msg);\n                window.robot.create(data.id, data.x, data.y, data.heading, data.reality);\n            } catch (e) {\n                console.error(e);\n            }\n        } else if (topic == TOPIC_ROBOT_DELETE) {\n            try {\n                var data = JSON.parse(msg);\n                window.robot.delete(data.id);\n            } catch (e) {\n                console.error(e);\n            }\n        } else if (topic == TOPIC_LOC_INFO_FROM_LOC_SYSTEMS || topic == TOPIC_LOC_INFO_FROM_SERVER) {\n            //Data from the localization server or virtual robots\n\n            try {\n                const data = JSON.parse(msg);\n                const REALITY = Config.mixedReality.robots;\n\n                // Render only the received data is same as configured reality\n                // or configuration allowed mixed reality\n                if (data != undefined) {\n                    // Have data on this reality\n                    for (const i in data) {\n                        const { id, x, y, heading } = data[i];\n                        const reality = data[i].reality == undefined ? 'V' : data[i].reality;\n\n                        if (reality === REALITY || REALITY === 'M') {\n                            // Create only if robots match with platform's allowed reality\n                            if (window.robot.exists(id) == undefined) {\n                                window.robot.create(id, x, y, heading, reality);\n                            } else {\n                                window.robot.move(id, x, y, heading);\n                                window.robot.setReality(id, reality);\n                            }\n                        } else {\n                            // reality not matching; remove\n                            robot.delete(id);\n                        }\n                    }\n                }\n            } catch (e) {\n                console.error(e);\n            }\n        } else if (topic == TOPIC_OBSTACLES_LIST) {\n            // Create obstacles in the arena\n            try {\n                const data = JSON.parse(msg);\n                window.obstacles.createList(data);\n            } catch (e) {\n                console.error(e);\n            }\n        } else if (topic == TOPIC_OBSTACLES_DELETE) {\n            // Delete obstacle given in the id\n            const data = JSON.parse(msg);\n            console.log(data);\n            window.obstacles.deleteIfExists(data.id);\n        } else if (topic == TOPIC_OBSTACLES_DELETE_ALL) {\n            // Delete all obstacles\n            window.obstacles.deleteAll();\n        } else if (topic == TOPIC_CHANGE_COLOR) {\n            try {\n                const data = JSON.parse(msg);\n                window.robot.changeColor(data.id, data.R, data.G, data.B);\n            } catch (e) {\n                console.error(e);\n            }\n        } else if (topic == TOPIC_ROBOT_BROADCAST) {\n            // Display a popup message\n            // TODO: Do this by a generalized function call\n\n            if (msg != 'ID? -1') {\n                const m = 'Broadcast Message: ' + msg.split(' ')[0];\n                const t = 1000 + msg.length * 95;\n\n                const disp = document.querySelector('#msg-box');\n                disp.innerHTML = m;\n                disp.style.display = 'block';\n\n                setTimeout(function () {\n                    document.querySelector('#msg-box').style.display = 'none';\n                }, t);\n            }\n        } else if (topic == TOPIC_MANAGEMENT_VISUALIZER) {\n            if (msg === 'REFRESH') {\n                console.log('page refresh request');\n                location.reload();\n            } else if (msg.startsWith('MSG')) {\n                const m = 'Notice: ' + msg.substring(4);\n                const t = 2000 + m.length * 95;\n\n                // Display a popup message\n                // TODO: Do this by a generalized function call\n                const disp = document.querySelector('#msg-box');\n                disp.innerHTML = m;\n                disp.style.display = 'block';\n\n                setTimeout(function () {\n                    document.querySelector('#msg-box').style.display = 'none';\n                }, t);\n            } else {\n                console.log('>Management:', msg);\n            }\n        } else if (msg.startsWith('MSG')) {\n            const m = 'Notice: ' + msg.substring(4);\n            const t = 2000 + m.length * 95;\n\n            // Display a popup message\n            // TODO: Do this by a generalized function call\n            const disp = document.querySelector('#msg-box');\n            disp.innerHTML = m;\n            disp.style.display = 'block';\n\n            setTimeout(function () {\n                document.querySelector('#msg-box').style.display = 'none';\n            }, t);\n        } else {\n        }\n    }\n\n    subscribe(topic, callback) {\n        const subTopic = window.channel + '/' + topic;\n        this.client.subscribe(subTopic);\n        console.log('MQTT: subscribed', subTopic);\n        if (callback != null) callback();\n    }\n\n    publish(topic, message, callback) {\n        var payload = new MQTT.Message(message);\n        const pubTopic = window.channel + '/' + topic;\n        payload.destinationName = pubTopic;\n        this.client.send(payload);\n        console.log('MQTT: published', pubTopic);\n\n        if (callback != null) callback();\n    }\n}\n","// Global imports -\nimport * as THREE from 'three';\nimport * as THREEAR from 'threear';\n\nimport TWEEN, { update } from '@tweenjs/tween.js';\n\n// Components\nimport Renderer from './components/renderer';\nimport Label from './components/label';\nimport Camera from './components/camera';\nimport Light from './components/light';\nimport Controls from './components/controls';\nimport Geometry from './components/geometry';\nimport Environment from './components/environment';\n\n// Config data\nimport Config from './../data/config';\n\n// Helpers\nimport Stats from './helpers/stats';\n\n// Managers\nimport DatGUI from './managers/datGUI';\n\n// Newly implemented classes\nimport MQTTClient from './managers/mqttClient';\n\n// Global Variables\nlet camera, labelRenderer, INTERSECTED, selectedLabel;\n\n// For click event on robots\n// const raycaster = new THREE.Raycaster();\n// const mouse = new THREE.Vector2();\n\n// This class instantiates and ties all of the components together, starts the loading process and renders the main loop\nexport default class Main {\n    constructor(container) {\n        this.container = container;\n\n        if (window.devicePixelRatio) {\n            Config.dpr = window.devicePixelRatio;\n        }\n\n        // Set up gui\n        if (Config.isDev) {\n            // this.gui = new DatGUI(this)\n        }\n\n        // Main scene creation, and set global scale\n        window.scene = new THREE.Scene();\n        window.scene_scale = Config.scale;\n\n        // High level reality flag\n        window.selectedReality = Config.selectedReality;\n\n        // Renderer object\n        window.renderer = new Renderer(scene, container).threeRenderer;\n\n        // init scene and camera\n        camera = new THREE.Camera();\n        // camera = new Camera(renderer); // Perspective camera giving an error\n        scene.add(camera);\n\n        // Create and place lights in scene\n        this.light = new Light(scene);\n        this.camera = camera;\n\n        const lights = ['ambient', 'directional', 'point', 'hemi'];\n        lights.forEach((light) => this.light.place(light));\n\n        var markerGroup = new THREE.Group();\n        scene.add(markerGroup);\n        window.markerGroup = markerGroup;\n\n        var source = new THREEAR.Source({ renderer, camera });\n\n        this.mqtt = new MQTTClient(scene, markerGroup);\n\n        // Set up Stats if dev environment\n        if (Config.isDev && Config.isShowingStats) {\n            this.stats = new Stats();\n            // this.container.appendChild(this.stats.dom);\n        }\n\n        if (Config.isShowingLables) {\n            this.labelRenderer = Label();\n            window.labelRenderer = this.labelRenderer; // add to global scope\n            this.container.appendChild(this.labelRenderer.domElement);\n        }\n\n        // Set up gui\n        if (Config.isDev) {\n            this.gui = new DatGUI(this);\n        }\n\n        THREEAR.initialize({ source: source }).then((controller) => {\n            //  -------------------------------------------------------\n            // Create the environment\n            this.environment = new Environment();\n\n            // -------------------------------------------------------\n            if (Config.isDev) {\n                this.gui.load(this);\n                // this.gui.show();\n            }\n\n            var patternMarker = new THREEAR.PatternMarker({\n                // patternUrl: './assets/data/hiro.patt',\n                patternUrl: './assets/data/pattern-kanji.patt',\n                markerObject: markerGroup\n            });\n\n            controller.trackMarker(patternMarker);\n\n            // run the rendering loop\n            var lastTimeMsec = 0;\n\n            requestAnimationFrame(function animate(nowMsec) {\n                // keep looping\n                requestAnimationFrame(animate);\n                // measure time\n                lastTimeMsec = lastTimeMsec || nowMsec - 1000 / 60;\n                var deltaMsec = Math.min(200, nowMsec - lastTimeMsec);\n                lastTimeMsec = nowMsec;\n\n                // call each update function\n                controller.update(source.domElement);\n\n                // Call render function and pass in created scene and camera\n                renderer.render(scene, camera);\n\n                // render labels if enabled\n                if (Config.isShowingLables) {\n                    window.labelRenderer.domElement.hidden = false;\n                } else {\n                    window.labelRenderer.domElement.hidden = true;\n                }\n\n                // window.labelRenderer.render(scene, camera.threeCamera);\n\n                if (Config.isDev && Config.isShowingStats) {\n                    // this.stats.update();\n                }\n\n                // Delta time is sometimes needed for certain updates\n                //const delta = this.clock.getDelta();\n\n                // Call any vendor or module frame updates here\n                TWEEN.update();\n                //this.controls.threeControls.update();\n            });\n        });\n\n        this.container.querySelector('#loading').style.display = 'none';\n\n        // Eventlistner for catching mouse click events\n        window.addEventListener('click', this.onDocumentMouseDown, false);\n    }\n\n    onDocumentMouseDown(event) {\n        event.preventDefault();\n\n        // // Not supported in AR so far\n        // mouse.x = (event.clientX / window.innerWidth) * 2 - 1;\n        // mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;\n        //\n        // raycaster.setFromCamera(mouse, camera);\n        //\n        // const intersects = raycaster.intersectObjects(scene.children);\n        //\n        // if (intersects.length > 0) {\n        //     const object = intersects[0].object;\n        //     if (INTERSECTED) INTERSECTED.material.setValues({ opacity: INTERSECTED.currentOpacity });\n        //     INTERSECTED = object;\n        //     selectedLabel = INTERSECTED.children[0];\n        //     INTERSECTED.currentOpacity = INTERSECTED.material.opacity;\n        //     INTERSECTED.labelsVisibility = INTERSECTED.material.labelVisibility;\n        //     if (selectedLabel !== undefined && selectedLabel.visible !== undefined && Config.isShowingLables) {\n        //         selectedLabel.visible = !selectedLabel.visible;\n        //     }\n        //     INTERSECTED.material.selected = !INTERSECTED.material.selected;\n        //     // Obstacle selection event handling\n        //     if (INTERSECTED.name.startsWith('Obstacle')) {\n        //         if (INTERSECTED.material.selected) {\n        //             INTERSECTED.currentHex = INTERSECTED.material.emissive.getHex();\n        //             INTERSECTED.material.emissive.setHex(0xf95f4a);\n        //         } else {\n        //             INTERSECTED.currentHex = INTERSECTED.material.userData.originalEmmisive;\n        //             INTERSECTED.material.emissive.setHex(INTERSECTED.currentHex);\n        //         }\n        //         // Robot selection event handling\n        //     } else if (INTERSECTED.name.startsWith('Robot')) {\n        //         if (INTERSECTED.material.selected) {\n        //             INTERSECTED.material.setValues({ opacity: 0.5 });\n        //         } else {\n        //             INTERSECTED.material.setValues({ opacity: 1 });\n        //         }\n        //         if (INTERSECTED.clickEvent !== undefined) {\n        //             INTERSECTED.clickEvent(INTERSECTED);\n        //         }\n        //     }\n        // } else {\n        //     if (INTERSECTED) INTERSECTED.material.setValues({ opacity: INTERSECTED.currentOpacity });\n        //     INTERSECTED = null;\n        // }\n    }\n\n    onDocumentMouseMove(event) {\n        event.preventDefault();\n\n        // // Not supported in AR so far\n        // mouse.x = (event.clientX / window.innerWidth) * 2 - 1;\n        // mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;\n        //\n        // raycaster.setFromCamera(mouse, camera.threeCamera);\n        //\n        // const intersects = raycaster.intersectObjects(scene.children, true);\n        // if (intersects.length > 0) {\n        //     const object = intersects[0].object;\n        //     if (INTERSECTED !== object) {\n        //         if (INTERSECTED) INTERSECTED.material.setValues({ opacity: INTERSECTED.currentOpacity });\n        //         INTERSECTED = object;\n        //         selectedLabel = INTERSECTED.children[0];\n        //         INTERSECTED.currentOpacity = INTERSECTED.material.opacity;\n        //         INTERSECTED.currentColor = INTERSECTED.material.opacity;\n        //         INTERSECTED.material.setValues({ color: 0x03dffc, opacity: 0.75 });\n        //     }\n        // } else {\n        //     if (INTERSECTED)\n        //     INTERSECTED.material.setValues({ opacity: 1.0, color: INTERSECTED.material.userData.originalColor });\n        //     INTERSECTED = null;\n        // }\n    }\n}\n","import Config from './data/config';\nimport Detector from './utils/detector';\nimport Main from './app/main';\n\n// Styles\nimport './../css/app.scss';\n// Check environment and set the Config helper\nif (__ENV__ === 'dev') {\n    console.log('----- RUNNING IN DEV ENVIRONMENT! -----');\n    Config.isDev = true;\n}\n\nfunction init() {\n    // Check for webGL capabilities\n    if (!Detector.webgl) {\n        Detector.addGetWebGLMessage();\n    } else {\n        const container = document.getElementById('appContainer');\n        new Main(container);\n    }\n}\n\ninit();\n"],"sourceRoot":""}